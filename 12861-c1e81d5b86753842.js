(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[12861],{55053:function(e){"use strict";for(var t="qpzry9x8gf2tvdw0s3jn54khce6mua7l",r={},n=0;n<t.length;n++){var i=t.charAt(n);if(void 0!==r[i])throw new TypeError(i+" is ambiguous");r[i]=n}function s(e){var t=e>>25;return(33554431&e)<<5^996825010&-(t>>0&1)^642813549&-(t>>1&1)^513874426&-(t>>2&1)^1027748829&-(t>>3&1)^705979059&-(t>>4&1)}function o(e){for(var t=1,r=0;r<e.length;++r){var n=e.charCodeAt(r);if(n<33||n>126)return"Invalid prefix ("+e+")";t=s(t)^n>>5}for(t=s(t),r=0;r<e.length;++r){var i=e.charCodeAt(r);t=s(t)^31&i}return t}function u(e,t){if(t=t||90,e.length<8)return e+" too short";if(e.length>t)return"Exceeds length limit";var n=e.toLowerCase(),i=e.toUpperCase();if(e!==n&&e!==i)return"Mixed-case string "+e;var u=(e=n).lastIndexOf("1");if(-1===u)return"No separator character for "+e;if(0===u)return"Missing prefix for "+e;var a=e.slice(0,u),c=e.slice(u+1);if(c.length<6)return"Data too short";var p=o(a);if("string"===typeof p)return p;for(var f=[],h=0;h<c.length;++h){var l=c.charAt(h),d=r[l];if(void 0===d)return"Unknown character "+l;p=s(p)^d,h+6>=c.length||f.push(d)}return 1!==p?"Invalid checksum for "+e:{prefix:a,words:f}}function a(e,t,r,n){for(var i=0,s=0,o=(1<<r)-1,u=[],a=0;a<e.length;++a)for(i=i<<t|e[a],s+=t;s>=r;)s-=r,u.push(i>>s&o);if(n)s>0&&u.push(i<<r-s&o);else{if(s>=t)return"Excess padding";if(i<<r-s&o)return"Non-zero padding"}return u}e.exports={decodeUnsafe:function(){var e=u.apply(null,arguments);if("object"===typeof e)return e},decode:function(e){var t=u.apply(null,arguments);if("object"===typeof t)return t;throw new Error(t)},encode:function(e,r,n){if(n=n||90,e.length+7+r.length>n)throw new TypeError("Exceeds length limit");var i=o(e=e.toLowerCase());if("string"===typeof i)throw new Error(i);for(var u=e+"1",a=0;a<r.length;++a){var c=r[a];if(c>>5!==0)throw new Error("Non 5-bit word");i=s(i)^c,u+=t.charAt(c)}for(a=0;a<6;++a)i=s(i);for(i^=1,a=0;a<6;++a){u+=t.charAt(i>>5*(5-a)&31)}return u},toWordsUnsafe:function(e){var t=a(e,8,5,!0);if(Array.isArray(t))return t},toWords:function(e){var t=a(e,8,5,!0);if(Array.isArray(t))return t;throw new Error(t)},fromWordsUnsafe:function(e){var t=a(e,5,8,!1);if(Array.isArray(t))return t},fromWords:function(e){var t=a(e,5,8,!1);if(Array.isArray(t))return t;throw new Error(t)}}},66598:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(90459);function i(e,t,r){return n=>{if(e.has(n))return;const i=r.filter((e=>e.key.toString("hex")===n))[0];t.push(i),e.add(n)}}function s(e){return e.globalMap.unsignedTx}function o(e){const t=new Set;return e.forEach((e=>{const r=e.key.toString("hex");if(t.has(r))throw new Error("Combine: KeyValue Map keys should be unique");t.add(r)})),t}t.combine=function(e){const t=e[0],r=n.psbtToKeyVals(t),u=e.slice(1);if(0===u.length)throw new Error("Combine: Nothing to combine");const a=s(t);if(void 0===a)throw new Error("Combine: Self missing transaction");const c=o(r.globalKeyVals),p=r.inputKeyVals.map(o),f=r.outputKeyVals.map(o);for(const h of u){const e=s(h);if(void 0===e||!e.toBuffer().equals(a.toBuffer()))throw new Error("Combine: One of the Psbts does not have the same transaction.");const t=n.psbtToKeyVals(h);o(t.globalKeyVals).forEach(i(c,r.globalKeyVals,t.globalKeyVals));t.inputKeyVals.map(o).forEach(((e,n)=>e.forEach(i(p[n],r.inputKeyVals[n],t.inputKeyVals[n]))));t.outputKeyVals.map(o).forEach(((e,n)=>e.forEach(i(f[n],r.outputKeyVals[n],t.outputKeyVals[n]))))}return n.psbtFromKeyVals(a,{globalMapKeyVals:r.globalKeyVals,inputKeyVals:r.inputKeyVals,outputKeyVals:r.outputKeyVals})}},23731:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(54200);t.decode=function(e){if(e.key[0]!==i.GlobalTypes.GLOBAL_XPUB)throw new Error("Decode Error: could not decode globalXpub with key 0x"+e.key.toString("hex"));if(79!==e.key.length||![2,3].includes(e.key[46]))throw new Error("Decode Error: globalXpub has invalid extended pubkey in key 0x"+e.key.toString("hex"));if(e.value.length/4%1!==0)throw new Error("Decode Error: Global GLOBAL_XPUB value length should be multiple of 4");const t=e.key.slice(1),r={masterFingerprint:e.value.slice(0,4),extendedPubkey:t,path:"m"};for(const i of(n=e.value.length/4-1,[...Array(n).keys()])){const t=e.value.readUInt32LE(4*i+4),n=!!(2147483648&t),s=2147483647&t;r.path+="/"+s.toString(10)+(n?"'":"")}var n;return r},t.encode=function(e){const t=n.from([i.GlobalTypes.GLOBAL_XPUB]),r=n.concat([t,e.extendedPubkey]),s=e.path.split("/"),o=n.allocUnsafe(4*s.length);e.masterFingerprint.copy(o,0);let u=4;return s.slice(1).forEach((e=>{const t="'"===e.slice(-1);let r=2147483647&parseInt(t?e.slice(0,-1):e,10);t&&(r+=2147483648),o.writeUInt32LE(r,u),u+=4})),{key:r,value:o}},t.expected="{ masterFingerprint: Buffer; extendedPubkey: Buffer; path: string; }",t.check=function(e){const t=e.extendedPubkey,r=e.masterFingerprint,i=e.path;return n.isBuffer(t)&&78===t.length&&[2,3].indexOf(t[45])>-1&&n.isBuffer(r)&&4===r.length&&"string"===typeof i&&!!i.match(/^m(\/\d+'?)+$/)},t.canAddToArray=function(e,t,r){const n=t.extendedPubkey.toString("hex");return!r.has(n)&&(r.add(n),0===e.filter((e=>e.extendedPubkey.equals(t.extendedPubkey))).length)}},77690:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(54200);t.encode=function(e){return{key:n.from([i.GlobalTypes.UNSIGNED_TX]),value:e.toBuffer()}}},34739:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(54200),i=r(23731),s=r(77690),o=r(37916),u=r(32212),a=r(74182),c=r(87542),p=r(1971),f=r(48929),h=r(40387),l=r(16920),d=r(81587),w=r(42799),_=r(31254),E={unsignedTx:s,globalXpub:i,checkPubkey:d.makeChecker([])};t.globals=E;const y={nonWitnessUtxo:a,partialSig:c,sighashType:f,finalScriptSig:o,finalScriptWitness:u,porCommitment:p,witnessUtxo:h,bip32Derivation:l.makeConverter(n.InputTypes.BIP32_DERIVATION),redeemScript:w.makeConverter(n.InputTypes.REDEEM_SCRIPT),witnessScript:_.makeConverter(n.InputTypes.WITNESS_SCRIPT),checkPubkey:d.makeChecker([n.InputTypes.PARTIAL_SIG,n.InputTypes.BIP32_DERIVATION])};t.inputs=y;const g={bip32Derivation:l.makeConverter(n.OutputTypes.BIP32_DERIVATION),redeemScript:w.makeConverter(n.OutputTypes.REDEEM_SCRIPT),witnessScript:_.makeConverter(n.OutputTypes.WITNESS_SCRIPT),checkPubkey:d.makeChecker([n.OutputTypes.BIP32_DERIVATION])};t.outputs=g},37916:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(54200);t.decode=function(e){if(e.key[0]!==i.InputTypes.FINAL_SCRIPTSIG)throw new Error("Decode Error: could not decode finalScriptSig with key 0x"+e.key.toString("hex"));return e.value},t.encode=function(e){return{key:n.from([i.InputTypes.FINAL_SCRIPTSIG]),value:e}},t.expected="Buffer",t.check=function(e){return n.isBuffer(e)},t.canAdd=function(e,t){return!!e&&!!t&&void 0===e.finalScriptSig}},32212:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(54200);t.decode=function(e){if(e.key[0]!==i.InputTypes.FINAL_SCRIPTWITNESS)throw new Error("Decode Error: could not decode finalScriptWitness with key 0x"+e.key.toString("hex"));return e.value},t.encode=function(e){return{key:n.from([i.InputTypes.FINAL_SCRIPTWITNESS]),value:e}},t.expected="Buffer",t.check=function(e){return n.isBuffer(e)},t.canAdd=function(e,t){return!!e&&!!t&&void 0===e.finalScriptWitness}},74182:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(54200);t.decode=function(e){if(e.key[0]!==i.InputTypes.NON_WITNESS_UTXO)throw new Error("Decode Error: could not decode nonWitnessUtxo with key 0x"+e.key.toString("hex"));return e.value},t.encode=function(e){return{key:n.from([i.InputTypes.NON_WITNESS_UTXO]),value:e}},t.expected="Buffer",t.check=function(e){return n.isBuffer(e)},t.canAdd=function(e,t){return!!e&&!!t&&void 0===e.nonWitnessUtxo}},87542:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(54200);t.decode=function(e){if(e.key[0]!==i.InputTypes.PARTIAL_SIG)throw new Error("Decode Error: could not decode partialSig with key 0x"+e.key.toString("hex"));if(34!==e.key.length&&66!==e.key.length||![2,3,4].includes(e.key[1]))throw new Error("Decode Error: partialSig has invalid pubkey in key 0x"+e.key.toString("hex"));return{pubkey:e.key.slice(1),signature:e.value}},t.encode=function(e){const t=n.from([i.InputTypes.PARTIAL_SIG]);return{key:n.concat([t,e.pubkey]),value:e.signature}},t.expected="{ pubkey: Buffer; signature: Buffer; }",t.check=function(e){return n.isBuffer(e.pubkey)&&n.isBuffer(e.signature)&&[33,65].includes(e.pubkey.length)&&[2,3,4].includes(e.pubkey[0])&&function(e){if(!n.isBuffer(e)||e.length<9)return!1;if(48!==e[0])return!1;if(e.length!==e[1]+3)return!1;if(2!==e[2])return!1;const t=e[3];if(t>33||t<1)return!1;if(2!==e[3+t+1])return!1;const r=e[3+t+2];return!(r>33||r<1)&&e.length===3+t+2+r+2}(e.signature)},t.canAddToArray=function(e,t,r){const n=t.pubkey.toString("hex");return!r.has(n)&&(r.add(n),0===e.filter((e=>e.pubkey.equals(t.pubkey))).length)}},1971:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(54200);t.decode=function(e){if(e.key[0]!==i.InputTypes.POR_COMMITMENT)throw new Error("Decode Error: could not decode porCommitment with key 0x"+e.key.toString("hex"));return e.value.toString("utf8")},t.encode=function(e){return{key:n.from([i.InputTypes.POR_COMMITMENT]),value:n.from(e,"utf8")}},t.expected="string",t.check=function(e){return"string"===typeof e},t.canAdd=function(e,t){return!!e&&!!t&&void 0===e.porCommitment}},48929:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(54200);t.decode=function(e){if(e.key[0]!==i.InputTypes.SIGHASH_TYPE)throw new Error("Decode Error: could not decode sighashType with key 0x"+e.key.toString("hex"));return e.value.readUInt32LE(0)},t.encode=function(e){const t=n.from([i.InputTypes.SIGHASH_TYPE]),r=n.allocUnsafe(4);return r.writeUInt32LE(e,0),{key:t,value:r}},t.expected="number",t.check=function(e){return"number"===typeof e},t.canAdd=function(e,t){return!!e&&!!t&&void 0===e.sighashType}},40387:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(54200),s=r(67438),o=r(31218);t.decode=function(e){if(e.key[0]!==i.InputTypes.WITNESS_UTXO)throw new Error("Decode Error: could not decode witnessUtxo with key 0x"+e.key.toString("hex"));const t=s.readUInt64LE(e.value,0);let r=8;const n=o.decode(e.value,r);r+=o.encodingLength(n);const u=e.value.slice(r);if(u.length!==n)throw new Error("Decode Error: WITNESS_UTXO script is not proper length");return{script:u,value:t}},t.encode=function(e){const{script:t,value:r}=e,u=o.encodingLength(t.length),a=n.allocUnsafe(8+u+t.length);return s.writeUInt64LE(a,r,0),o.encode(t.length,a,8),t.copy(a,8+u),{key:n.from([i.InputTypes.WITNESS_UTXO]),value:a}},t.expected="{ script: Buffer; value: number; }",t.check=function(e){return n.isBuffer(e.script)&&"number"===typeof e.value},t.canAdd=function(e,t){return!!e&&!!t&&void 0===e.witnessUtxo}},16920:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0});t.makeConverter=function(e){return{decode:function(t){if(t.key[0]!==e)throw new Error("Decode Error: could not decode bip32Derivation with key 0x"+t.key.toString("hex"));if(34!==t.key.length&&66!==t.key.length||![2,3,4].includes(t.key[1]))throw new Error("Decode Error: bip32Derivation has invalid pubkey in key 0x"+t.key.toString("hex"));if(t.value.length/4%1!==0)throw new Error("Decode Error: Input BIP32_DERIVATION value length should be multiple of 4");const r=t.key.slice(1),n={masterFingerprint:t.value.slice(0,4),pubkey:r,path:"m"};for(const e of(i=t.value.length/4-1,[...Array(i).keys()])){const r=t.value.readUInt32LE(4*e+4),i=!!(2147483648&r),s=2147483647&r;n.path+="/"+s.toString(10)+(i?"'":"")}var i;return n},encode:function(t){const r=n.from([e]),i=n.concat([r,t.pubkey]),s=t.path.split("/"),o=n.allocUnsafe(4*s.length);t.masterFingerprint.copy(o,0);let u=4;return s.slice(1).forEach((e=>{const t="'"===e.slice(-1);let r=2147483647&parseInt(t?e.slice(0,-1):e,10);t&&(r+=2147483648),o.writeUInt32LE(r,u),u+=4})),{key:i,value:o}},check:function(e){return n.isBuffer(e.pubkey)&&n.isBuffer(e.masterFingerprint)&&"string"===typeof e.path&&[33,65].includes(e.pubkey.length)&&[2,3,4].includes(e.pubkey[0])&&4===e.masterFingerprint.length},expected:"{ masterFingerprint: Buffer; pubkey: Buffer; path: string; }",canAddToArray:function(e,t,r){const n=t.pubkey.toString("hex");return!r.has(n)&&(r.add(n),0===e.filter((e=>e.pubkey.equals(t.pubkey))).length)}}}},81587:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeChecker=function(e){return function(t){let r;if(e.includes(t.key[0])&&(r=t.key.slice(1),33!==r.length&&65!==r.length||![2,3,4].includes(r[0])))throw new Error("Format Error: invalid pubkey in key 0x"+t.key.toString("hex"));return r}}},42799:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.makeConverter=function(e){return{decode:function(t){if(t.key[0]!==e)throw new Error("Decode Error: could not decode redeemScript with key 0x"+t.key.toString("hex"));return t.value},encode:function(t){return{key:n.from([e]),value:t}},check:function(e){return n.isBuffer(e)},expected:"Buffer",canAdd:function(e,t){return!!e&&!!t&&void 0===e.redeemScript}}}},31254:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.makeConverter=function(e){return{decode:function(t){if(t.key[0]!==e)throw new Error("Decode Error: could not decode witnessScript with key 0x"+t.key.toString("hex"));return t.value},encode:function(t){return{key:n.from([e]),value:t}},check:function(e){return n.isBuffer(e)},expected:"Buffer",canAdd:function(e,t){return!!e&&!!t&&void 0===e.witnessScript}}}},67438:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(31218);function s(e){const t=e.key.length,r=e.value.length,s=i.encodingLength(t),o=i.encodingLength(r),u=n.allocUnsafe(s+t+o+r);return i.encode(t,u,0),e.key.copy(u,s),i.encode(r,u,s+t),e.value.copy(u,s+t+o),u}function o(e,t){if("number"!==typeof e)throw new Error("cannot write a non-number as a number");if(e<0)throw new Error("specified a negative value for writing an unsigned value");if(e>t)throw new Error("RangeError: value out of range");if(Math.floor(e)!==e)throw new Error("value has a fractional component")}t.range=e=>[...Array(e).keys()],t.reverseBuffer=function(e){if(e.length<1)return e;let t=e.length-1,r=0;for(let n=0;n<e.length/2;n++)r=e[n],e[n]=e[t],e[t]=r,t--;return e},t.keyValsToBuffer=function(e){const t=e.map(s);return t.push(n.from([0])),n.concat(t)},t.keyValToBuffer=s,t.readUInt64LE=function(e,t){const r=e.readUInt32LE(t);let n=e.readUInt32LE(t+4);return n*=4294967296,o(n+r,9007199254740991),n+r},t.writeUInt64LE=function(e,t,r){return o(t,9007199254740991),e.writeInt32LE(-1&t,r),e.writeUInt32LE(Math.floor(t/4294967296),r+4),r+8}},31218:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0});function i(e){if(e<0||e>9007199254740991||e%1!==0)throw new RangeError("value out of range")}function s(e){return i(e),e<253?1:e<=65535?3:e<=4294967295?5:9}t.encode=function e(t,r,o){if(i(t),r||(r=n.allocUnsafe(s(t))),!n.isBuffer(r))throw new TypeError("buffer must be a Buffer instance");return o||(o=0),t<253?(r.writeUInt8(t,o),Object.assign(e,{bytes:1})):t<=65535?(r.writeUInt8(253,o),r.writeUInt16LE(t,o+1),Object.assign(e,{bytes:3})):t<=4294967295?(r.writeUInt8(254,o),r.writeUInt32LE(t,o+1),Object.assign(e,{bytes:5})):(r.writeUInt8(255,o),r.writeUInt32LE(t>>>0,o+1),r.writeUInt32LE(t/4294967296|0,o+5),Object.assign(e,{bytes:9})),r},t.decode=function e(t,r){if(!n.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");r||(r=0);const s=t.readUInt8(r);if(s<253)return Object.assign(e,{bytes:1}),s;if(253===s)return Object.assign(e,{bytes:3}),t.readUInt16LE(r+1);if(254===s)return Object.assign(e,{bytes:5}),t.readUInt32LE(r+1);{Object.assign(e,{bytes:9});const n=t.readUInt32LE(r+1),s=4294967296*t.readUInt32LE(r+5)+n;return i(s),s}},t.encodingLength=s},70163:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(34739),s=r(67438),o=r(31218),u=r(54200);function a(e,t,r){if(!t.equals(n.from([r])))throw new Error(`Format Error: Invalid ${e} key: ${t.toString("hex")}`)}function c(e,{globalMapKeyVals:t,inputKeyVals:r,outputKeyVals:n}){const o={unsignedTx:e};let c=0;for(const s of t)switch(s.key[0]){case u.GlobalTypes.UNSIGNED_TX:if(a("global",s.key,u.GlobalTypes.UNSIGNED_TX),c>0)throw new Error("Format Error: GlobalMap has multiple UNSIGNED_TX");c++;break;case u.GlobalTypes.GLOBAL_XPUB:void 0===o.globalXpub&&(o.globalXpub=[]),o.globalXpub.push(i.globals.globalXpub.decode(s));break;default:o.unknownKeyVals||(o.unknownKeyVals=[]),o.unknownKeyVals.push(s)}const p=r.length,f=n.length,h=[],l=[];for(const d of s.range(p)){const e={};for(const t of r[d])switch(i.inputs.checkPubkey(t),t.key[0]){case u.InputTypes.NON_WITNESS_UTXO:if(a("input",t.key,u.InputTypes.NON_WITNESS_UTXO),void 0!==e.nonWitnessUtxo)throw new Error("Format Error: Input has multiple NON_WITNESS_UTXO");e.nonWitnessUtxo=i.inputs.nonWitnessUtxo.decode(t);break;case u.InputTypes.WITNESS_UTXO:if(a("input",t.key,u.InputTypes.WITNESS_UTXO),void 0!==e.witnessUtxo)throw new Error("Format Error: Input has multiple WITNESS_UTXO");e.witnessUtxo=i.inputs.witnessUtxo.decode(t);break;case u.InputTypes.PARTIAL_SIG:void 0===e.partialSig&&(e.partialSig=[]),e.partialSig.push(i.inputs.partialSig.decode(t));break;case u.InputTypes.SIGHASH_TYPE:if(a("input",t.key,u.InputTypes.SIGHASH_TYPE),void 0!==e.sighashType)throw new Error("Format Error: Input has multiple SIGHASH_TYPE");e.sighashType=i.inputs.sighashType.decode(t);break;case u.InputTypes.REDEEM_SCRIPT:if(a("input",t.key,u.InputTypes.REDEEM_SCRIPT),void 0!==e.redeemScript)throw new Error("Format Error: Input has multiple REDEEM_SCRIPT");e.redeemScript=i.inputs.redeemScript.decode(t);break;case u.InputTypes.WITNESS_SCRIPT:if(a("input",t.key,u.InputTypes.WITNESS_SCRIPT),void 0!==e.witnessScript)throw new Error("Format Error: Input has multiple WITNESS_SCRIPT");e.witnessScript=i.inputs.witnessScript.decode(t);break;case u.InputTypes.BIP32_DERIVATION:void 0===e.bip32Derivation&&(e.bip32Derivation=[]),e.bip32Derivation.push(i.inputs.bip32Derivation.decode(t));break;case u.InputTypes.FINAL_SCRIPTSIG:a("input",t.key,u.InputTypes.FINAL_SCRIPTSIG),e.finalScriptSig=i.inputs.finalScriptSig.decode(t);break;case u.InputTypes.FINAL_SCRIPTWITNESS:a("input",t.key,u.InputTypes.FINAL_SCRIPTWITNESS),e.finalScriptWitness=i.inputs.finalScriptWitness.decode(t);break;case u.InputTypes.POR_COMMITMENT:a("input",t.key,u.InputTypes.POR_COMMITMENT),e.porCommitment=i.inputs.porCommitment.decode(t);break;default:e.unknownKeyVals||(e.unknownKeyVals=[]),e.unknownKeyVals.push(t)}h.push(e)}for(const d of s.range(f)){const e={};for(const t of n[d])switch(i.outputs.checkPubkey(t),t.key[0]){case u.OutputTypes.REDEEM_SCRIPT:if(a("output",t.key,u.OutputTypes.REDEEM_SCRIPT),void 0!==e.redeemScript)throw new Error("Format Error: Output has multiple REDEEM_SCRIPT");e.redeemScript=i.outputs.redeemScript.decode(t);break;case u.OutputTypes.WITNESS_SCRIPT:if(a("output",t.key,u.OutputTypes.WITNESS_SCRIPT),void 0!==e.witnessScript)throw new Error("Format Error: Output has multiple WITNESS_SCRIPT");e.witnessScript=i.outputs.witnessScript.decode(t);break;case u.OutputTypes.BIP32_DERIVATION:void 0===e.bip32Derivation&&(e.bip32Derivation=[]),e.bip32Derivation.push(i.outputs.bip32Derivation.decode(t));break;default:e.unknownKeyVals||(e.unknownKeyVals=[]),e.unknownKeyVals.push(t)}l.push(e)}return{globalMap:o,inputs:h,outputs:l}}t.psbtFromBuffer=function(e,t){let r=0;function n(){const t=o.decode(e,r);r+=o.encodingLength(t);const n=e.slice(r,r+t);return r+=t,n}function i(){return{key:n(),value:n()}}function a(){if(r>=e.length)throw new Error("Format Error: Unexpected End of PSBT");const t=0===e.readUInt8(r);return t&&r++,t}if(1886610036!==function(){const t=e.readUInt32BE(r);return r+=4,t}())throw new Error("Format Error: Invalid Magic Number");if(255!==function(){const t=e.readUInt8(r);return r+=1,t}())throw new Error("Format Error: Magic Number must be followed by 0xff separator");const p=[],f={};for(;!a();){const e=i(),t=e.key.toString("hex");if(f[t])throw new Error("Format Error: Keys must be unique for global keymap: key "+t);f[t]=1,p.push(e)}const h=p.filter((e=>e.key[0]===u.GlobalTypes.UNSIGNED_TX));if(1!==h.length)throw new Error("Format Error: Only one UNSIGNED_TX allowed");const l=t(h[0].value),{inputCount:d,outputCount:w}=l.getInputOutputCounts(),_=[],E=[];for(const o of s.range(d)){const e={},t=[];for(;!a();){const r=i(),n=r.key.toString("hex");if(e[n])throw new Error("Format Error: Keys must be unique for each input: input index "+o+" key "+n);e[n]=1,t.push(r)}_.push(t)}for(const o of s.range(w)){const e={},t=[];for(;!a();){const r=i(),n=r.key.toString("hex");if(e[n])throw new Error("Format Error: Keys must be unique for each output: output index "+o+" key "+n);e[n]=1,t.push(r)}E.push(t)}return c(l,{globalMapKeyVals:p,inputKeyVals:_,outputKeyVals:E})},t.checkKeyBuffer=a,t.psbtFromKeyVals=c},90459:function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(70163)),n(r(61947))},61947:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(34739),s=r(67438);t.psbtToBuffer=function({globalMap:e,inputs:t,outputs:r}){const{globalKeyVals:i,inputKeyVals:o,outputKeyVals:u}=a({globalMap:e,inputs:t,outputs:r}),c=s.keyValsToBuffer(i),p=e=>0===e.length?[n.from([0])]:e.map(s.keyValsToBuffer),f=p(o),h=p(u),l=n.allocUnsafe(5);return l.writeUIntBE(482972169471,0,5),n.concat([l,c].concat(f,h))};const o=(e,t)=>e.key.compare(t.key);function u(e,t){const r=new Set,n=Object.entries(e).reduce(((e,[n,i])=>{if("unknownKeyVals"===n)return e;const s=t[n];if(void 0===s)return e;const o=(Array.isArray(i)?i:[i]).map(s.encode);return o.map((e=>e.key.toString("hex"))).forEach((e=>{if(r.has(e))throw new Error("Serialize Error: Duplicate key: "+e);r.add(e)})),e.concat(o)}),[]),i=e.unknownKeyVals?e.unknownKeyVals.filter((e=>!r.has(e.key.toString("hex")))):[];return n.concat(i).sort(o)}function a({globalMap:e,inputs:t,outputs:r}){return{globalKeyVals:u(e,i.globals),inputKeyVals:t.map((e=>u(e,i.inputs))),outputKeyVals:r.map((e=>u(e,i.outputs)))}}t.psbtToKeyVals=a},23215:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(66598),s=r(90459),o=r(54200),u=r(62919);t.Psbt=class{constructor(e){this.inputs=[],this.outputs=[],this.globalMap={unsignedTx:e}}static fromBase64(e,t){const r=n.from(e,"base64");return this.fromBuffer(r,t)}static fromHex(e,t){const r=n.from(e,"hex");return this.fromBuffer(r,t)}static fromBuffer(e,t){const r=s.psbtFromBuffer(e,t),n=new this(r.globalMap.unsignedTx);return Object.assign(n,r),n}toBase64(){return this.toBuffer().toString("base64")}toHex(){return this.toBuffer().toString("hex")}toBuffer(){return s.psbtToBuffer(this)}updateGlobal(e){return u.updateGlobal(e,this.globalMap),this}updateInput(e,t){const r=u.checkForInput(this.inputs,e);return u.updateInput(t,r),this}updateOutput(e,t){const r=u.checkForOutput(this.outputs,e);return u.updateOutput(t,r),this}addUnknownKeyValToGlobal(e){return u.checkHasKey(e,this.globalMap.unknownKeyVals,u.getEnumLength(o.GlobalTypes)),this.globalMap.unknownKeyVals||(this.globalMap.unknownKeyVals=[]),this.globalMap.unknownKeyVals.push(e),this}addUnknownKeyValToInput(e,t){const r=u.checkForInput(this.inputs,e);return u.checkHasKey(t,r.unknownKeyVals,u.getEnumLength(o.InputTypes)),r.unknownKeyVals||(r.unknownKeyVals=[]),r.unknownKeyVals.push(t),this}addUnknownKeyValToOutput(e,t){const r=u.checkForOutput(this.outputs,e);return u.checkHasKey(t,r.unknownKeyVals,u.getEnumLength(o.OutputTypes)),r.unknownKeyVals||(r.unknownKeyVals=[]),r.unknownKeyVals.push(t),this}addInput(e){this.globalMap.unsignedTx.addInput(e),this.inputs.push({unknownKeyVals:[]});const t=e.unknownKeyVals||[],r=this.inputs.length-1;if(!Array.isArray(t))throw new Error("unknownKeyVals must be an Array");return t.forEach((e=>this.addUnknownKeyValToInput(r,e))),u.addInputAttributes(this.inputs,e),this}addOutput(e){this.globalMap.unsignedTx.addOutput(e),this.outputs.push({unknownKeyVals:[]});const t=e.unknownKeyVals||[],r=this.outputs.length-1;if(!Array.isArray(t))throw new Error("unknownKeyVals must be an Array");return t.forEach((e=>this.addUnknownKeyValToInput(r,e))),u.addOutputAttributes(this.outputs,e),this}clearFinalizedInput(e){const t=u.checkForInput(this.inputs,e);u.inputCheckUncleanFinalized(e,t);for(const r of Object.keys(t))["witnessUtxo","nonWitnessUtxo","finalScriptSig","finalScriptWitness","unknownKeyVals"].includes(r)||delete t[r];return this}combine(...e){const t=i.combine([this].concat(e));return Object.assign(this,t),this}getTransaction(){return this.globalMap.unsignedTx.toBuffer()}}},54200:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.UNSIGNED_TX=0]="UNSIGNED_TX",e[e.GLOBAL_XPUB=1]="GLOBAL_XPUB"}(t.GlobalTypes||(t.GlobalTypes={})),t.GLOBAL_TYPE_NAMES=["unsignedTx","globalXpub"],function(e){e[e.NON_WITNESS_UTXO=0]="NON_WITNESS_UTXO",e[e.WITNESS_UTXO=1]="WITNESS_UTXO",e[e.PARTIAL_SIG=2]="PARTIAL_SIG",e[e.SIGHASH_TYPE=3]="SIGHASH_TYPE",e[e.REDEEM_SCRIPT=4]="REDEEM_SCRIPT",e[e.WITNESS_SCRIPT=5]="WITNESS_SCRIPT",e[e.BIP32_DERIVATION=6]="BIP32_DERIVATION",e[e.FINAL_SCRIPTSIG=7]="FINAL_SCRIPTSIG",e[e.FINAL_SCRIPTWITNESS=8]="FINAL_SCRIPTWITNESS",e[e.POR_COMMITMENT=9]="POR_COMMITMENT"}(t.InputTypes||(t.InputTypes={})),t.INPUT_TYPE_NAMES=["nonWitnessUtxo","witnessUtxo","partialSig","sighashType","redeemScript","witnessScript","bip32Derivation","finalScriptSig","finalScriptWitness","porCommitment"],function(e){e[e.REDEEM_SCRIPT=0]="REDEEM_SCRIPT",e[e.WITNESS_SCRIPT=1]="WITNESS_SCRIPT",e[e.BIP32_DERIVATION=2]="BIP32_DERIVATION"}(t.OutputTypes||(t.OutputTypes={})),t.OUTPUT_TYPE_NAMES=["redeemScript","witnessScript","bip32Derivation"]},62919:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(34739);function s(e,t){const r=e[t];if(void 0===r)throw new Error(`No input #${t}`);return r}function o(e,t,r,n){throw new Error(`Data for ${e} key ${t} is incorrect: Expected ${r} and got ${JSON.stringify(n)}`)}function u(e){return(t,r)=>{for(const n of Object.keys(t)){const s=t[n],{canAdd:u,canAddToArray:a,check:c,expected:p}=i[e+"s"][n]||{},f=!!a;if(c)if(f){if(!Array.isArray(s)||r[n]&&!Array.isArray(r[n]))throw new Error(`Key type ${n} must be an array`);s.every(c)||o(e,n,p,s);const t=r[n]||[],i=new Set;if(!s.every((e=>a(t,e,i))))throw new Error("Can not add duplicate data to array");r[n]=t.concat(s)}else{if(c(s)||o(e,n,p,s),!u(r,s))throw new Error(`Can not add duplicate data to ${e}`);r[n]=s}}}}t.checkForInput=s,t.checkForOutput=function(e,t){const r=e[t];if(void 0===r)throw new Error(`No output #${t}`);return r},t.checkHasKey=function(e,t,r){if(e.key[0]<r)throw new Error("Use the method for your specific key instead of addUnknownKeyVal*");if(t&&0!==t.filter((t=>t.key.equals(e.key))).length)throw new Error(`Duplicate Key: ${e.key.toString("hex")}`)},t.getEnumLength=function(e){let t=0;return Object.keys(e).forEach((e=>{Number(isNaN(Number(e)))&&t++})),t},t.inputCheckUncleanFinalized=function(e,t){let r=!1;if(t.nonWitnessUtxo||t.witnessUtxo){const e=!!t.redeemScript,n=!!t.witnessScript,i=!e||!!t.finalScriptSig,s=!n||!!t.finalScriptWitness,o=!!t.finalScriptSig||!!t.finalScriptWitness;r=i&&s&&o}if(!1===r)throw new Error(`Input #${e} has too much or too little data to clean`)},t.updateGlobal=u("global"),t.updateInput=u("input"),t.updateOutput=u("output"),t.addInputAttributes=function(e,r){const n=s(e,e.length-1);t.updateInput(r,n)},t.addOutputAttributes=function(e,r){const n=s(e,e.length-1);t.updateOutput(r,n)},t.defaultVersionSetter=function(e,t){if(!n.isBuffer(t)||t.length<4)throw new Error("Set Version: Invalid Transaction");return t.writeUInt32LE(e,0),t},t.defaultLocktimeSetter=function(e,t){if(!n.isBuffer(t)||t.length<4)throw new Error("Set Locktime: Invalid Transaction");return t.writeUInt32LE(e,t.length-4),t}},73198:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(50646),s=r(2882),o=r(8674),u=r(41569),a=r(63760),c=u.BufferN(32),p=u.compile({wif:u.UInt8,bip32:{public:u.UInt32,private:u.UInt32}}),f={messagePrefix:"\x18Bitcoin Signed Message:\n",bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128},h=2147483648,l=Math.pow(2,31)-1;function d(e){return u.String(e)&&null!==e.match(/^(m\/)?(\d+'?\/)*\d+'?$/)}function w(e){return u.UInt32(e)&&e<=l}class _{constructor(e,t,r,n,i=0,s=0,o=0){this.__D=e,this.__Q=t,this.chainCode=r,this.network=n,this.__DEPTH=i,this.__INDEX=s,this.__PARENT_FINGERPRINT=o,u(p,n),this.lowR=!1}get depth(){return this.__DEPTH}get index(){return this.__INDEX}get parentFingerprint(){return this.__PARENT_FINGERPRINT}get publicKey(){return void 0===this.__Q&&(this.__Q=o.pointFromScalar(this.__D,!0)),this.__Q}get privateKey(){return this.__D}get identifier(){return i.hash160(this.publicKey)}get fingerprint(){return this.identifier.slice(0,4)}get compressed(){return!0}isNeutered(){return void 0===this.__D}neutered(){return g(this.publicKey,this.chainCode,this.network,this.depth,this.index,this.parentFingerprint)}toBase58(){const e=this.network,t=this.isNeutered()?e.bip32.public:e.bip32.private,r=n.allocUnsafe(78);return r.writeUInt32BE(t,0),r.writeUInt8(this.depth,4),r.writeUInt32BE(this.parentFingerprint,5),r.writeUInt32BE(this.index,9),this.chainCode.copy(r,13),this.isNeutered()?this.publicKey.copy(r,45):(r.writeUInt8(0,45),this.privateKey.copy(r,46)),s.encode(r)}toWIF(){if(!this.privateKey)throw new TypeError("Missing private key");return a.encode(this.network.wif,this.privateKey,!0)}derive(e){u(u.UInt32,e);const t=e>=h,r=n.allocUnsafe(37);if(t){if(this.isNeutered())throw new TypeError("Missing private key for hardened child key");r[0]=0,this.privateKey.copy(r,1),r.writeUInt32BE(e,33)}else this.publicKey.copy(r,0),r.writeUInt32BE(e,33);const s=i.hmacSHA512(this.chainCode,r),a=s.slice(0,32),c=s.slice(32);if(!o.isPrivate(a))return this.derive(e+1);let p;if(this.isNeutered()){const t=o.pointAddScalar(this.publicKey,a,!0);if(null===t)return this.derive(e+1);p=g(t,c,this.network,this.depth+1,e,this.fingerprint.readUInt32BE(0))}else{const t=o.privateAdd(this.privateKey,a);if(null==t)return this.derive(e+1);p=y(t,c,this.network,this.depth+1,e,this.fingerprint.readUInt32BE(0))}return p}deriveHardened(e){return u(w,e),this.derive(e+h)}derivePath(e){u(d,e);let t=e.split("/");if("m"===t[0]){if(this.parentFingerprint)throw new TypeError("Expected master, got child");t=t.slice(1)}return t.reduce(((e,t)=>{let r;return"'"===t.slice(-1)?(r=parseInt(t.slice(0,-1),10),e.deriveHardened(r)):(r=parseInt(t,10),e.derive(r))}),this)}sign(e,t){if(!this.privateKey)throw new Error("Missing private key");if(void 0===t&&(t=this.lowR),!1===t)return o.sign(e,this.privateKey);{let t=o.sign(e,this.privateKey);const r=n.alloc(32,0);let i=0;for(;t[0]>127;)i++,r.writeUIntLE(i,0,6),t=o.signWithEntropy(e,this.privateKey,r);return t}}verify(e,t){return o.verify(e,this.publicKey,t)}}function E(e,t,r){return y(e,t,r)}function y(e,t,r,n,i,s){if(u({privateKey:c,chainCode:c},{privateKey:e,chainCode:t}),r=r||f,!o.isPrivate(e))throw new TypeError("Private key not in range [1, n)");return new _(e,void 0,t,r,n,i,s)}function g(e,t,r,n,i,s){if(u({publicKey:u.BufferN(33),chainCode:c},{publicKey:e,chainCode:t}),r=r||f,!o.isPoint(e))throw new TypeError("Point is not on the curve");return new _(void 0,e,t,r,n,i,s)}t.fromBase58=function(e,t){const r=s.decode(e);if(78!==r.length)throw new TypeError("Invalid buffer length");t=t||f;const n=r.readUInt32BE(0);if(n!==t.bip32.private&&n!==t.bip32.public)throw new TypeError("Invalid network version");const i=r[4],o=r.readUInt32BE(5);if(0===i&&0!==o)throw new TypeError("Invalid parent fingerprint");const u=r.readUInt32BE(9);if(0===i&&0!==u)throw new TypeError("Invalid index");const a=r.slice(13,45);let c;if(n===t.bip32.private){if(0!==r.readUInt8(45))throw new TypeError("Invalid private key");c=y(r.slice(46,78),a,t,i,u,o)}else{c=g(r.slice(45,78),a,t,i,u,o)}return c},t.fromPrivateKey=E,t.fromPublicKey=function(e,t,r){return g(e,t,r)},t.fromSeed=function(e,t){if(u(u.Buffer,e),e.length<16)throw new TypeError("Seed should be at least 128 bits");if(e.length>64)throw new TypeError("Seed should be at most 512 bits");t=t||f;const r=i.hmacSHA512(n.from("Bitcoin seed","utf8"),e);return E(r.slice(0,32),r.slice(32),t)}},50646:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(2757),i=r(96829);t.hash160=function(e){const t=n("sha256").update(e).digest();try{return n("rmd160").update(t).digest()}catch(r){return n("ripemd160").update(t).digest()}},t.hmacSHA512=function(e,t){return i("sha512",e).update(t).digest()}},89097:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(73198);t.fromSeed=n.fromSeed,t.fromBase58=n.fromBase58,t.fromPublicKey=n.fromPublicKey,t.fromPrivateKey=n.fromPrivateKey},19443:function(e,t,r){var n=r(52761).Buffer;e.exports={check:function(e){if(e.length<8)return!1;if(e.length>72)return!1;if(48!==e[0])return!1;if(e[1]!==e.length-2)return!1;if(2!==e[2])return!1;var t=e[3];if(0===t)return!1;if(5+t>=e.length)return!1;if(2!==e[4+t])return!1;var r=e[5+t];return 0!==r&&(6+t+r===e.length&&(!(128&e[4])&&(!(t>1&&0===e[4]&&!(128&e[5]))&&(!(128&e[t+6])&&!(r>1&&0===e[t+6]&&!(128&e[t+7]))))))},decode:function(e){if(e.length<8)throw new Error("DER sequence length is too short");if(e.length>72)throw new Error("DER sequence length is too long");if(48!==e[0])throw new Error("Expected DER sequence");if(e[1]!==e.length-2)throw new Error("DER sequence length is invalid");if(2!==e[2])throw new Error("Expected DER integer");var t=e[3];if(0===t)throw new Error("R length is zero");if(5+t>=e.length)throw new Error("R length is too long");if(2!==e[4+t])throw new Error("Expected DER integer (2)");var r=e[5+t];if(0===r)throw new Error("S length is zero");if(6+t+r!==e.length)throw new Error("S length is invalid");if(128&e[4])throw new Error("R value is negative");if(t>1&&0===e[4]&&!(128&e[5]))throw new Error("R value excessively padded");if(128&e[t+6])throw new Error("S value is negative");if(r>1&&0===e[t+6]&&!(128&e[t+7]))throw new Error("S value excessively padded");return{r:e.slice(4,4+t),s:e.slice(6+t)}},encode:function(e,t){var r=e.length,i=t.length;if(0===r)throw new Error("R length is zero");if(0===i)throw new Error("S length is zero");if(r>33)throw new Error("R length is too long");if(i>33)throw new Error("S length is too long");if(128&e[0])throw new Error("R value is negative");if(128&t[0])throw new Error("S value is negative");if(r>1&&0===e[0]&&!(128&e[1]))throw new Error("R value excessively padded");if(i>1&&0===t[0]&&!(128&t[1]))throw new Error("S value excessively padded");var s=n.allocUnsafe(6+r+i);return s[0]=48,s[1]=s.length-2,s[2]=2,s[3]=e.length,e.copy(s,4),s[4+r]=2,s[5+r]=t.length,t.copy(s,6+r),s}}},92056:function(e,t,r){var n=r(39991),i={};for(var s in n){i[n[s]]=s}e.exports=i},56406:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(51002),s=r(37398),o=r(29386),u=r(99455),a=r(55053),c=r(2882),p=r(41569);function f(e){const t=c.decode(e);if(t.length<21)throw new TypeError(e+" is too short");if(t.length>21)throw new TypeError(e+" is too long");return{version:t.readUInt8(0),hash:t.slice(1)}}function h(e){const t=a.decode(e),r=a.fromWords(t.words.slice(1));return{version:t.words[0],prefix:t.prefix,data:n.from(r)}}t.fromBase58Check=f,t.fromBech32=h,t.toBase58Check=function(e,t){p(u.tuple(u.Hash160bit,u.UInt8),arguments);const r=n.allocUnsafe(21);return r.writeUInt8(t,0),e.copy(r,1),c.encode(r)},t.toBech32=function(e,t,r){const n=a.toWords(e);return n.unshift(t),a.encode(r,n)},t.fromOutputScript=function(e,t){t=t||i.bitcoin;try{return s.p2pkh({output:e,network:t}).address}catch(r){}try{return s.p2sh({output:e,network:t}).address}catch(r){}try{return s.p2wpkh({output:e,network:t}).address}catch(r){}try{return s.p2wsh({output:e,network:t}).address}catch(r){}throw new Error(o.toASM(e)+" has no matching Address")},t.toOutputScript=function(e,t){let r,n;t=t||i.bitcoin;try{r=f(e)}catch(o){}if(r){if(r.version===t.pubKeyHash)return s.p2pkh({hash:r.hash}).output;if(r.version===t.scriptHash)return s.p2sh({hash:r.hash}).output}else{try{n=h(e)}catch(o){}if(n){if(n.prefix!==t.bech32)throw new Error(e+" has an invalid prefix");if(0===n.version){if(20===n.data.length)return s.p2wpkh({hash:n.data}).output;if(32===n.data.length)return s.p2wsh({hash:n.data}).output}}}throw new Error(e+" has no matching Script")}},75622:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(48715),s=r(89717),o=r(36005),u=r(99455),a=r(62403),c=r(41569),p=r(52941),f=new TypeError("Cannot compute merkle root for zero transactions"),h=new TypeError("Cannot compute witness commit for non-segwit block");class l{constructor(){this.version=1,this.prevHash=void 0,this.merkleRoot=void 0,this.timestamp=0,this.witnessCommit=void 0,this.bits=0,this.nonce=0,this.transactions=void 0}static fromBuffer(e){if(e.length<80)throw new Error("Buffer too small (< 80 bytes)");const t=new i.BufferReader(e),r=new l;if(r.version=t.readInt32(),r.prevHash=t.readSlice(32),r.merkleRoot=t.readSlice(32),r.timestamp=t.readUInt32(),r.bits=t.readUInt32(),r.nonce=t.readUInt32(),80===e.length)return r;const n=()=>{const e=o.Transaction.fromBuffer(t.buffer.slice(t.offset),!0);return t.offset+=e.byteLength(),e},s=t.readVarInt();r.transactions=[];for(let i=0;i<s;++i){const e=n();r.transactions.push(e)}const u=r.getWitnessCommit();return u&&(r.witnessCommit=u),r}static fromHex(e){return l.fromBuffer(n.from(e,"hex"))}static calculateTarget(e){const t=((4278190080&e)>>24)-3,r=8388607&e,i=n.alloc(32,0);return i.writeUIntBE(r,29-t,3),i}static calculateMerkleRoot(e,t){if(c([{getHash:u.Function}],e),0===e.length)throw f;if(t&&!d(e))throw h;const r=e.map((e=>e.getHash(t))),i=a(r,s.hash256);return t?s.hash256(n.concat([i,e[0].ins[0].witness[0]])):i}getWitnessCommit(){if(!d(this.transactions))return null;const e=this.transactions[0].outs.filter((e=>e.script.slice(0,6).equals(n.from("6a24aa21a9ed","hex")))).map((e=>e.script.slice(6,38)));if(0===e.length)return null;const t=e[e.length-1];return t instanceof n&&32===t.length?t:null}hasWitnessCommit(){return this.witnessCommit instanceof n&&32===this.witnessCommit.length||null!==this.getWitnessCommit()}hasWitness(){return(e=this.transactions)instanceof Array&&e.some((e=>"object"===typeof e&&e.ins instanceof Array&&e.ins.some((e=>"object"===typeof e&&e.witness instanceof Array&&e.witness.length>0))));var e}weight(){return 3*this.byteLength(!1,!1)+this.byteLength(!1,!0)}byteLength(e,t=!0){return e||!this.transactions?80:80+p.encodingLength(this.transactions.length)+this.transactions.reduce(((e,r)=>e+r.byteLength(t)),0)}getHash(){return s.hash256(this.toBuffer(!0))}getId(){return i.reverseBuffer(this.getHash()).toString("hex")}getUTCDate(){const e=new Date(0);return e.setUTCSeconds(this.timestamp),e}toBuffer(e){const t=n.allocUnsafe(this.byteLength(e)),r=new i.BufferWriter(t);return r.writeInt32(this.version),r.writeSlice(this.prevHash),r.writeSlice(this.merkleRoot),r.writeUInt32(this.timestamp),r.writeUInt32(this.bits),r.writeUInt32(this.nonce),e||!this.transactions||(p.encode(this.transactions.length,t,r.offset),r.offset+=p.encode.bytes,this.transactions.forEach((e=>{const n=e.byteLength();e.toBuffer(t,r.offset),r.offset+=n}))),t}toHex(e){return this.toBuffer(e).toString("hex")}checkTxRoots(){const e=this.hasWitnessCommit();return!(!e&&this.hasWitness())&&(this.__checkMerkleRoot()&&(!e||this.__checkWitnessCommit()))}checkProofOfWork(){const e=i.reverseBuffer(this.getHash()),t=l.calculateTarget(this.bits);return e.compare(t)<=0}__checkMerkleRoot(){if(!this.transactions)throw f;const e=l.calculateMerkleRoot(this.transactions);return 0===this.merkleRoot.compare(e)}__checkWitnessCommit(){if(!this.transactions)throw f;if(!this.hasWitnessCommit())throw h;const e=l.calculateMerkleRoot(this.transactions,!0);return 0===this.witnessCommit.compare(e)}}function d(e){return e instanceof Array&&e[0]&&e[0].ins&&e[0].ins instanceof Array&&e[0].ins[0]&&e[0].ins[0].witness&&e[0].ins[0].witness instanceof Array&&e[0].ins[0].witness.length>0}t.Block=l},48715:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(99455),s=r(41569),o=r(52941);function u(e,t){if("number"!==typeof e)throw new Error("cannot write a non-number as a number");if(e<0)throw new Error("specified a negative value for writing an unsigned value");if(e>t)throw new Error("RangeError: value out of range");if(Math.floor(e)!==e)throw new Error("value has a fractional component")}function a(e,t){const r=e.readUInt32LE(t);let n=e.readUInt32LE(t+4);return n*=4294967296,u(n+r,9007199254740991),n+r}function c(e,t,r){return u(t,9007199254740991),e.writeInt32LE(-1&t,r),e.writeUInt32LE(Math.floor(t/4294967296),r+4),r+8}t.readUInt64LE=a,t.writeUInt64LE=c,t.reverseBuffer=function(e){if(e.length<1)return e;let t=e.length-1,r=0;for(let n=0;n<e.length/2;n++)r=e[n],e[n]=e[t],e[t]=r,t--;return e},t.cloneBuffer=function(e){const t=n.allocUnsafe(e.length);return e.copy(t),t};t.BufferWriter=class{constructor(e,t=0){this.buffer=e,this.offset=t,s(i.tuple(i.Buffer,i.UInt32),[e,t])}writeUInt8(e){this.offset=this.buffer.writeUInt8(e,this.offset)}writeInt32(e){this.offset=this.buffer.writeInt32LE(e,this.offset)}writeUInt32(e){this.offset=this.buffer.writeUInt32LE(e,this.offset)}writeUInt64(e){this.offset=c(this.buffer,e,this.offset)}writeVarInt(e){o.encode(e,this.buffer,this.offset),this.offset+=o.encode.bytes}writeSlice(e){if(this.buffer.length<this.offset+e.length)throw new Error("Cannot write slice out of bounds");this.offset+=e.copy(this.buffer,this.offset)}writeVarSlice(e){this.writeVarInt(e.length),this.writeSlice(e)}writeVector(e){this.writeVarInt(e.length),e.forEach((e=>this.writeVarSlice(e)))}};t.BufferReader=class{constructor(e,t=0){this.buffer=e,this.offset=t,s(i.tuple(i.Buffer,i.UInt32),[e,t])}readUInt8(){const e=this.buffer.readUInt8(this.offset);return this.offset++,e}readInt32(){const e=this.buffer.readInt32LE(this.offset);return this.offset+=4,e}readUInt32(){const e=this.buffer.readUInt32LE(this.offset);return this.offset+=4,e}readUInt64(){const e=a(this.buffer,this.offset);return this.offset+=8,e}readVarInt(){const e=o.decode(this.buffer,this.offset);return this.offset+=o.decode.bytes,e}readSlice(e){if(this.buffer.length<this.offset+e)throw new Error("Cannot read slice out of bounds");const t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}readVarSlice(){return this.readSlice(this.readVarInt())}readVector(){const e=this.readVarInt(),t=[];for(let r=0;r<e;r++)t.push(this.readVarSlice());return t}}},53737:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(29386),i=r(89811),s=r(97776),o=r(24765),u=r(36471),a=r(96387),c=r(67980),p=r(78229),f=r(22789),h={P2MS:"multisig",NONSTANDARD:"nonstandard",NULLDATA:"nulldata",P2PK:"pubkey",P2PKH:"pubkeyhash",P2SH:"scripthash",P2WPKH:"witnesspubkeyhash",P2WSH:"witnessscripthash",WITNESS_COMMITMENT:"witnesscommitment"};t.types=h,t.output=function(e){if(p.output.check(e))return h.P2WPKH;if(f.output.check(e))return h.P2WSH;if(u.output.check(e))return h.P2PKH;if(a.output.check(e))return h.P2SH;const t=n.decompile(e);if(!t)throw new TypeError("Invalid script");return i.output.check(t)?h.P2MS:o.output.check(t)?h.P2PK:c.output.check(t)?h.WITNESS_COMMITMENT:s.output.check(t)?h.NULLDATA:h.NONSTANDARD},t.input=function(e,t){const r=n.decompile(e);if(!r)throw new TypeError("Invalid script");return u.input.check(r)?h.P2PKH:a.input.check(r,t)?h.P2SH:i.input.check(r,t)?h.P2MS:o.input.check(r)?h.P2PK:h.NONSTANDARD},t.witness=function(e,t){const r=n.decompile(e);if(!r)throw new TypeError("Invalid script");return p.input.check(r)?h.P2WPKH:f.input.check(r,t)?h.P2WSH:h.NONSTANDARD}},89717:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(2757);function i(e){try{return n("rmd160").update(e).digest()}catch(t){return n("ripemd160").update(e).digest()}}function s(e){return n("sha256").update(e).digest()}t.ripemd160=i,t.sha1=function(e){return n("sha1").update(e).digest()},t.sha256=s,t.hash160=function(e){return i(s(e))},t.hash256=function(e){return s(s(e))}},39247:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(51002),s=r(99455),o=r(8674),u=r(13545),a=r(41569),c=r(63760),p=a.maybe(a.compile({compressed:s.maybe(s.Boolean),network:s.maybe(s.Network)}));class f{constructor(e,t,r){this.__D=e,this.__Q=t,this.lowR=!1,void 0===r&&(r={}),this.compressed=void 0===r.compressed||r.compressed,this.network=r.network||i.bitcoin,void 0!==t&&(this.__Q=o.pointCompress(t,this.compressed))}get privateKey(){return this.__D}get publicKey(){return this.__Q||(this.__Q=o.pointFromScalar(this.__D,this.compressed)),this.__Q}toWIF(){if(!this.__D)throw new Error("Missing private key");return c.encode(this.network.wif,this.__D,this.compressed)}sign(e,t){if(!this.__D)throw new Error("Missing private key");if(void 0===t&&(t=this.lowR),!1===t)return o.sign(e,this.__D);{let t=o.sign(e,this.__D);const r=n.alloc(32,0);let i=0;for(;t[0]>127;)i++,r.writeUIntLE(i,0,6),t=o.signWithEntropy(e,this.__D,r);return t}}verify(e,t){return o.verify(e,this.publicKey,t)}}function h(e,t){if(a(s.Buffer256bit,e),!o.isPrivate(e))throw new TypeError("Private key not in range [1, n)");return a(p,t),new f(e,void 0,t)}t.fromPrivateKey=h,t.fromPublicKey=function(e,t){return a(o.isPoint,e),a(p,t),new f(void 0,e,t)},t.fromWIF=function(e,t){const r=c.decode(e),n=r.version;if(s.Array(t)){if(!(t=t.filter((e=>n===e.wif)).pop()))throw new Error("Unknown network version")}else if(t=t||i.bitcoin,n!==t.wif)throw new Error("Invalid network version");return h(r.privateKey,{compressed:r.compressed,network:t})},t.makeRandom=function(e){a(p,e),void 0===e&&(e={});const t=e.rng||u;let r;do{r=t(32),a(s.Buffer256bit,r)}while(!o.isPrivate(r));return h(r,e)}},33432:function(e,t,r){"use strict";r(89097);const n=r(56406);t.Lk=n;const i=r(89717);t.eL=i;r(39247);const s=r(51002);t.QW=s;const o=r(37398);t.PP=o;const u=r(29386);t._v=u,r(75622).Block;var a=r(9483);t._B=a.Psbt,r(29386).OPS,r(36005).Transaction,r(89765).TransactionBuilder},51002:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bitcoin={messagePrefix:"\x18Bitcoin Signed Message:\n",bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128},t.regtest={messagePrefix:"\x18Bitcoin Signed Message:\n",bech32:"bcrt",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239},t.testnet={messagePrefix:"\x18Bitcoin Signed Message:\n",bech32:"tb",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239}},43536:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(51002),i=r(29386),s=r(94169),o=r(41569),u=i.OPS;t.p2data=function(e,t){if(!e.data&&!e.output)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),o({network:o.maybe(o.Object),output:o.maybe(o.Buffer),data:o.maybe(o.arrayOf(o.Buffer))},e);const r={name:"embed",network:e.network||n.bitcoin};if(s.prop(r,"output",(()=>{if(e.data)return i.compile([u.OP_RETURN].concat(e.data))})),s.prop(r,"data",(()=>{if(e.output)return i.decompile(e.output).slice(1)})),t.validate&&e.output){const t=i.decompile(e.output);if(t[0]!==u.OP_RETURN)throw new TypeError("Output is invalid");if(!t.slice(1).every(o.Buffer))throw new TypeError("Output is invalid");if(e.data&&!function(e,t){return e.length===t.length&&e.every(((e,r)=>e.equals(t[r])))}(e.data,r.data))throw new TypeError("Data mismatch")}return Object.assign(r,e)}},37398:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(43536);t.embed=n.p2data;const i=r(90418);t.p2ms=i.p2ms;const s=r(41150);t.p2pk=s.p2pk;const o=r(77264);t.p2pkh=o.p2pkh;const u=r(69431);t.p2sh=u.p2sh;const a=r(24937);t.p2wpkh=a.p2wpkh;const c=r(51857);t.p2wsh=c.p2wsh},94169:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.prop=function(e,t,r){Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get(){const e=r.call(this);return this[t]=e,e},set(e){Object.defineProperty(this,t,{configurable:!0,enumerable:!0,value:e,writable:!0})}})},t.value=function(e){let t;return()=>(void 0!==t||(t=e()),t)}},90418:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(51002),i=r(29386),s=r(94169),o=i.OPS,u=r(41569),a=r(8674),c=o.OP_RESERVED;function p(e,t){return e.length===t.length&&e.every(((e,r)=>e.equals(t[r])))}t.p2ms=function(e,t){if(!e.input&&!e.output&&(!e.pubkeys||void 0===e.m)&&!e.signatures)throw new TypeError("Not enough data");function r(e){return i.isCanonicalScriptSignature(e)||void 0!==(t.allowIncomplete&&e===o.OP_0)}t=Object.assign({validate:!0},t||{}),u({network:u.maybe(u.Object),m:u.maybe(u.Number),n:u.maybe(u.Number),output:u.maybe(u.Buffer),pubkeys:u.maybe(u.arrayOf(a.isPoint)),signatures:u.maybe(u.arrayOf(r)),input:u.maybe(u.Buffer)},e);const f={network:e.network||n.bitcoin};let h=[],l=!1;function d(e){l||(l=!0,h=i.decompile(e),f.m=h[0]-c,f.n=h[h.length-2]-c,f.pubkeys=h.slice(1,-2))}if(s.prop(f,"output",(()=>{if(e.m&&f.n&&e.pubkeys)return i.compile([].concat(c+e.m,e.pubkeys,c+f.n,o.OP_CHECKMULTISIG))})),s.prop(f,"m",(()=>{if(f.output)return d(f.output),f.m})),s.prop(f,"n",(()=>{if(f.pubkeys)return f.pubkeys.length})),s.prop(f,"pubkeys",(()=>{if(e.output)return d(e.output),f.pubkeys})),s.prop(f,"signatures",(()=>{if(e.input)return i.decompile(e.input).slice(1)})),s.prop(f,"input",(()=>{if(e.signatures)return i.compile([o.OP_0].concat(e.signatures))})),s.prop(f,"witness",(()=>{if(f.input)return[]})),s.prop(f,"name",(()=>{if(f.m&&f.n)return`p2ms(${f.m} of ${f.n})`})),t.validate){if(e.output){if(d(e.output),!u.Number(h[0]))throw new TypeError("Output is invalid");if(!u.Number(h[h.length-2]))throw new TypeError("Output is invalid");if(h[h.length-1]!==o.OP_CHECKMULTISIG)throw new TypeError("Output is invalid");if(f.m<=0||f.n>16||f.m>f.n||f.n!==h.length-3)throw new TypeError("Output is invalid");if(!f.pubkeys.every((e=>a.isPoint(e))))throw new TypeError("Output is invalid");if(void 0!==e.m&&e.m!==f.m)throw new TypeError("m mismatch");if(void 0!==e.n&&e.n!==f.n)throw new TypeError("n mismatch");if(e.pubkeys&&!p(e.pubkeys,f.pubkeys))throw new TypeError("Pubkeys mismatch")}if(e.pubkeys){if(void 0!==e.n&&e.n!==e.pubkeys.length)throw new TypeError("Pubkey count mismatch");if(f.n=e.pubkeys.length,f.n<f.m)throw new TypeError("Pubkey count cannot be less than m")}if(e.signatures){if(e.signatures.length<f.m)throw new TypeError("Not enough signatures provided");if(e.signatures.length>f.m)throw new TypeError("Too many signatures provided")}if(e.input){if(e.input[0]!==o.OP_0)throw new TypeError("Input is invalid");if(0===f.signatures.length||!f.signatures.every(r))throw new TypeError("Input has invalid signature(s)");if(e.signatures&&!p(e.signatures,f.signatures))throw new TypeError("Signature mismatch");if(void 0!==e.m&&e.m!==e.signatures.length)throw new TypeError("Signature count mismatch")}}return Object.assign(f,e)}},41150:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(51002),i=r(29386),s=r(94169),o=r(41569),u=i.OPS,a=r(8674);t.p2pk=function(e,t){if(!e.input&&!e.output&&!e.pubkey&&!e.input&&!e.signature)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),o({network:o.maybe(o.Object),output:o.maybe(o.Buffer),pubkey:o.maybe(a.isPoint),signature:o.maybe(i.isCanonicalScriptSignature),input:o.maybe(o.Buffer)},e);const r=s.value((()=>i.decompile(e.input))),c={name:"p2pk",network:e.network||n.bitcoin};if(s.prop(c,"output",(()=>{if(e.pubkey)return i.compile([e.pubkey,u.OP_CHECKSIG])})),s.prop(c,"pubkey",(()=>{if(e.output)return e.output.slice(1,-1)})),s.prop(c,"signature",(()=>{if(e.input)return r()[0]})),s.prop(c,"input",(()=>{if(e.signature)return i.compile([e.signature])})),s.prop(c,"witness",(()=>{if(c.input)return[]})),t.validate){if(e.output){if(e.output[e.output.length-1]!==u.OP_CHECKSIG)throw new TypeError("Output is invalid");if(!a.isPoint(c.pubkey))throw new TypeError("Output pubkey is invalid");if(e.pubkey&&!e.pubkey.equals(c.pubkey))throw new TypeError("Pubkey mismatch")}if(e.signature&&e.input&&!e.input.equals(c.input))throw new TypeError("Signature mismatch");if(e.input){if(1!==r().length)throw new TypeError("Input is invalid");if(!i.isCanonicalScriptSignature(c.signature))throw new TypeError("Input has invalid signature")}}return Object.assign(c,e)}},77264:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(89717),s=r(51002),o=r(29386),u=r(94169),a=r(41569),c=o.OPS,p=r(8674),f=r(2882);t.p2pkh=function(e,t){if(!e.address&&!e.hash&&!e.output&&!e.pubkey&&!e.input)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),a({network:a.maybe(a.Object),address:a.maybe(a.String),hash:a.maybe(a.BufferN(20)),output:a.maybe(a.BufferN(25)),pubkey:a.maybe(p.isPoint),signature:a.maybe(o.isCanonicalScriptSignature),input:a.maybe(a.Buffer)},e);const r=u.value((()=>{const t=f.decode(e.address);return{version:t.readUInt8(0),hash:t.slice(1)}})),h=u.value((()=>o.decompile(e.input))),l=e.network||s.bitcoin,d={name:"p2pkh",network:l};if(u.prop(d,"address",(()=>{if(!d.hash)return;const e=n.allocUnsafe(21);return e.writeUInt8(l.pubKeyHash,0),d.hash.copy(e,1),f.encode(e)})),u.prop(d,"hash",(()=>e.output?e.output.slice(3,23):e.address?r().hash:e.pubkey||d.pubkey?i.hash160(e.pubkey||d.pubkey):void 0)),u.prop(d,"output",(()=>{if(d.hash)return o.compile([c.OP_DUP,c.OP_HASH160,d.hash,c.OP_EQUALVERIFY,c.OP_CHECKSIG])})),u.prop(d,"pubkey",(()=>{if(e.input)return h()[1]})),u.prop(d,"signature",(()=>{if(e.input)return h()[0]})),u.prop(d,"input",(()=>{if(e.pubkey&&e.signature)return o.compile([e.signature,e.pubkey])})),u.prop(d,"witness",(()=>{if(d.input)return[]})),t.validate){let t=n.from([]);if(e.address){if(r().version!==l.pubKeyHash)throw new TypeError("Invalid version or Network mismatch");if(20!==r().hash.length)throw new TypeError("Invalid address");t=r().hash}if(e.hash){if(t.length>0&&!t.equals(e.hash))throw new TypeError("Hash mismatch");t=e.hash}if(e.output){if(25!==e.output.length||e.output[0]!==c.OP_DUP||e.output[1]!==c.OP_HASH160||20!==e.output[2]||e.output[23]!==c.OP_EQUALVERIFY||e.output[24]!==c.OP_CHECKSIG)throw new TypeError("Output is invalid");const r=e.output.slice(3,23);if(t.length>0&&!t.equals(r))throw new TypeError("Hash mismatch");t=r}if(e.pubkey){const r=i.hash160(e.pubkey);if(t.length>0&&!t.equals(r))throw new TypeError("Hash mismatch");t=r}if(e.input){const r=h();if(2!==r.length)throw new TypeError("Input is invalid");if(!o.isCanonicalScriptSignature(r[0]))throw new TypeError("Input has invalid signature");if(!p.isPoint(r[1]))throw new TypeError("Input has invalid pubkey");if(e.signature&&!e.signature.equals(r[0]))throw new TypeError("Signature mismatch");if(e.pubkey&&!e.pubkey.equals(r[1]))throw new TypeError("Pubkey mismatch");const n=i.hash160(r[1]);if(t.length>0&&!t.equals(n))throw new TypeError("Hash mismatch")}}return Object.assign(d,e)}},69431:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(89717),s=r(51002),o=r(29386),u=r(94169),a=r(41569),c=o.OPS,p=r(2882);t.p2sh=function(e,t){if(!e.address&&!e.hash&&!e.output&&!e.redeem&&!e.input)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),a({network:a.maybe(a.Object),address:a.maybe(a.String),hash:a.maybe(a.BufferN(20)),output:a.maybe(a.BufferN(23)),redeem:a.maybe({network:a.maybe(a.Object),output:a.maybe(a.Buffer),input:a.maybe(a.Buffer),witness:a.maybe(a.arrayOf(a.Buffer))}),input:a.maybe(a.Buffer),witness:a.maybe(a.arrayOf(a.Buffer))},e);let r=e.network;r||(r=e.redeem&&e.redeem.network||s.bitcoin);const f={network:r},h=u.value((()=>{const t=p.decode(e.address);return{version:t.readUInt8(0),hash:t.slice(1)}})),l=u.value((()=>o.decompile(e.input))),d=u.value((()=>{const t=l();return{network:r,output:t[t.length-1],input:o.compile(t.slice(0,-1)),witness:e.witness||[]}}));if(u.prop(f,"address",(()=>{if(!f.hash)return;const e=n.allocUnsafe(21);return e.writeUInt8(f.network.scriptHash,0),f.hash.copy(e,1),p.encode(e)})),u.prop(f,"hash",(()=>e.output?e.output.slice(2,22):e.address?h().hash:f.redeem&&f.redeem.output?i.hash160(f.redeem.output):void 0)),u.prop(f,"output",(()=>{if(f.hash)return o.compile([c.OP_HASH160,f.hash,c.OP_EQUAL])})),u.prop(f,"redeem",(()=>{if(e.input)return d()})),u.prop(f,"input",(()=>{if(e.redeem&&e.redeem.input&&e.redeem.output)return o.compile([].concat(o.decompile(e.redeem.input),e.redeem.output))})),u.prop(f,"witness",(()=>f.redeem&&f.redeem.witness?f.redeem.witness:f.input?[]:void 0)),u.prop(f,"name",(()=>{const e=["p2sh"];return void 0!==f.redeem&&e.push(f.redeem.name),e.join("-")})),t.validate){let t=n.from([]);if(e.address){if(h().version!==r.scriptHash)throw new TypeError("Invalid version or Network mismatch");if(20!==h().hash.length)throw new TypeError("Invalid address");t=h().hash}if(e.hash){if(t.length>0&&!t.equals(e.hash))throw new TypeError("Hash mismatch");t=e.hash}if(e.output){if(23!==e.output.length||e.output[0]!==c.OP_HASH160||20!==e.output[1]||e.output[22]!==c.OP_EQUAL)throw new TypeError("Output is invalid");const r=e.output.slice(2,22);if(t.length>0&&!t.equals(r))throw new TypeError("Hash mismatch");t=r}const s=e=>{if(e.output){const r=o.decompile(e.output);if(!r||r.length<1)throw new TypeError("Redeem.output too short");const n=i.hash160(e.output);if(t.length>0&&!t.equals(n))throw new TypeError("Hash mismatch");t=n}if(e.input){const t=e.input.length>0,r=e.witness&&e.witness.length>0;if(!t&&!r)throw new TypeError("Empty input");if(t&&r)throw new TypeError("Input and witness provided");if(t){const t=o.decompile(e.input);if(!o.isPushOnly(t))throw new TypeError("Non push-only scriptSig")}}};if(e.input){const e=l();if(!e||e.length<1)throw new TypeError("Input too short");if(!n.isBuffer(d().output))throw new TypeError("Input is invalid");s(d())}if(e.redeem){if(e.redeem.network&&e.redeem.network!==r)throw new TypeError("Network mismatch");if(e.input){const t=d();if(e.redeem.output&&!e.redeem.output.equals(t.output))throw new TypeError("Redeem.output mismatch");if(e.redeem.input&&!e.redeem.input.equals(t.input))throw new TypeError("Redeem.input mismatch")}s(e.redeem)}if(e.witness&&e.redeem&&e.redeem.witness&&!function(e,t){return e.length===t.length&&e.every(((e,r)=>e.equals(t[r])))}(e.redeem.witness,e.witness))throw new TypeError("Witness and redeem.witness mismatch")}return Object.assign(f,e)}},24937:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(89717),s=r(51002),o=r(29386),u=r(94169),a=r(41569),c=o.OPS,p=r(8674),f=r(55053),h=n.alloc(0);t.p2wpkh=function(e,t){if(!e.address&&!e.hash&&!e.output&&!e.pubkey&&!e.witness)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),a({address:a.maybe(a.String),hash:a.maybe(a.BufferN(20)),input:a.maybe(a.BufferN(0)),network:a.maybe(a.Object),output:a.maybe(a.BufferN(22)),pubkey:a.maybe(p.isPoint),signature:a.maybe(o.isCanonicalScriptSignature),witness:a.maybe(a.arrayOf(a.Buffer))},e);const r=u.value((()=>{const t=f.decode(e.address),r=t.words.shift(),i=f.fromWords(t.words);return{version:r,prefix:t.prefix,data:n.from(i)}})),l=e.network||s.bitcoin,d={name:"p2wpkh",network:l};if(u.prop(d,"address",(()=>{if(!d.hash)return;const e=f.toWords(d.hash);return e.unshift(0),f.encode(l.bech32,e)})),u.prop(d,"hash",(()=>e.output?e.output.slice(2,22):e.address?r().data:e.pubkey||d.pubkey?i.hash160(e.pubkey||d.pubkey):void 0)),u.prop(d,"output",(()=>{if(d.hash)return o.compile([c.OP_0,d.hash])})),u.prop(d,"pubkey",(()=>e.pubkey?e.pubkey:e.witness?e.witness[1]:void 0)),u.prop(d,"signature",(()=>{if(e.witness)return e.witness[0]})),u.prop(d,"input",(()=>{if(d.witness)return h})),u.prop(d,"witness",(()=>{if(e.pubkey&&e.signature)return[e.signature,e.pubkey]})),t.validate){let t=n.from([]);if(e.address){if(l&&l.bech32!==r().prefix)throw new TypeError("Invalid prefix or Network mismatch");if(0!==r().version)throw new TypeError("Invalid address version");if(20!==r().data.length)throw new TypeError("Invalid address data");t=r().data}if(e.hash){if(t.length>0&&!t.equals(e.hash))throw new TypeError("Hash mismatch");t=e.hash}if(e.output){if(22!==e.output.length||e.output[0]!==c.OP_0||20!==e.output[1])throw new TypeError("Output is invalid");if(t.length>0&&!t.equals(e.output.slice(2)))throw new TypeError("Hash mismatch");t=e.output.slice(2)}if(e.pubkey){const r=i.hash160(e.pubkey);if(t.length>0&&!t.equals(r))throw new TypeError("Hash mismatch");if(t=r,!p.isPoint(e.pubkey)||33!==e.pubkey.length)throw new TypeError("Invalid pubkey for p2wpkh")}if(e.witness){if(2!==e.witness.length)throw new TypeError("Witness is invalid");if(!o.isCanonicalScriptSignature(e.witness[0]))throw new TypeError("Witness has invalid signature");if(!p.isPoint(e.witness[1])||33!==e.witness[1].length)throw new TypeError("Witness has invalid pubkey");if(e.signature&&!e.signature.equals(e.witness[0]))throw new TypeError("Signature mismatch");if(e.pubkey&&!e.pubkey.equals(e.witness[1]))throw new TypeError("Pubkey mismatch");const r=i.hash160(e.witness[1]);if(t.length>0&&!t.equals(r))throw new TypeError("Hash mismatch")}}return Object.assign(d,e)}},51857:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(89717),s=r(51002),o=r(29386),u=r(94169),a=r(41569),c=o.OPS,p=r(8674),f=r(55053),h=n.alloc(0);function l(e){return!(!n.isBuffer(e)||65!==e.length||4!==e[0]||!p.isPoint(e))}t.p2wsh=function(e,t){if(!e.address&&!e.hash&&!e.output&&!e.redeem&&!e.witness)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),a({network:a.maybe(a.Object),address:a.maybe(a.String),hash:a.maybe(a.BufferN(32)),output:a.maybe(a.BufferN(34)),redeem:a.maybe({input:a.maybe(a.Buffer),network:a.maybe(a.Object),output:a.maybe(a.Buffer),witness:a.maybe(a.arrayOf(a.Buffer))}),input:a.maybe(a.BufferN(0)),witness:a.maybe(a.arrayOf(a.Buffer))},e);const r=u.value((()=>{const t=f.decode(e.address),r=t.words.shift(),i=f.fromWords(t.words);return{version:r,prefix:t.prefix,data:n.from(i)}})),p=u.value((()=>o.decompile(e.redeem.input)));let d=e.network;d||(d=e.redeem&&e.redeem.network||s.bitcoin);const w={network:d};if(u.prop(w,"address",(()=>{if(!w.hash)return;const e=f.toWords(w.hash);return e.unshift(0),f.encode(d.bech32,e)})),u.prop(w,"hash",(()=>e.output?e.output.slice(2):e.address?r().data:w.redeem&&w.redeem.output?i.sha256(w.redeem.output):void 0)),u.prop(w,"output",(()=>{if(w.hash)return o.compile([c.OP_0,w.hash])})),u.prop(w,"redeem",(()=>{if(e.witness)return{output:e.witness[e.witness.length-1],input:h,witness:e.witness.slice(0,-1)}})),u.prop(w,"input",(()=>{if(w.witness)return h})),u.prop(w,"witness",(()=>{if(e.redeem&&e.redeem.input&&e.redeem.input.length>0&&e.redeem.output&&e.redeem.output.length>0){const t=o.toStack(p());return w.redeem=Object.assign({witness:t},e.redeem),w.redeem.input=h,[].concat(t,e.redeem.output)}if(e.redeem&&e.redeem.output&&e.redeem.witness)return[].concat(e.redeem.witness,e.redeem.output)})),u.prop(w,"name",(()=>{const e=["p2wsh"];return void 0!==w.redeem&&e.push(w.redeem.name),e.join("-")})),t.validate){let t=n.from([]);if(e.address){if(r().prefix!==d.bech32)throw new TypeError("Invalid prefix or Network mismatch");if(0!==r().version)throw new TypeError("Invalid address version");if(32!==r().data.length)throw new TypeError("Invalid address data");t=r().data}if(e.hash){if(t.length>0&&!t.equals(e.hash))throw new TypeError("Hash mismatch");t=e.hash}if(e.output){if(34!==e.output.length||e.output[0]!==c.OP_0||32!==e.output[1])throw new TypeError("Output is invalid");const r=e.output.slice(2);if(t.length>0&&!t.equals(r))throw new TypeError("Hash mismatch");t=r}if(e.redeem){if(e.redeem.network&&e.redeem.network!==d)throw new TypeError("Network mismatch");if(e.redeem.input&&e.redeem.input.length>0&&e.redeem.witness&&e.redeem.witness.length>0)throw new TypeError("Ambiguous witness source");if(e.redeem.output){if(0===o.decompile(e.redeem.output).length)throw new TypeError("Redeem.output is invalid");const r=i.sha256(e.redeem.output);if(t.length>0&&!t.equals(r))throw new TypeError("Hash mismatch");t=r}if(e.redeem.input&&!o.isPushOnly(p()))throw new TypeError("Non push-only scriptSig");if(e.witness&&e.redeem.witness&&!function(e,t){return e.length===t.length&&e.every(((e,r)=>e.equals(t[r])))}(e.witness,e.redeem.witness))throw new TypeError("Witness and redeem.witness mismatch");if(e.redeem.input&&p().some(l)||e.redeem.output&&(o.decompile(e.redeem.output)||[]).some(l))throw new TypeError("redeem.input or redeem.output contains uncompressed pubkey")}if(e.witness&&e.witness.length>0){const t=e.witness[e.witness.length-1];if(e.redeem&&e.redeem.output&&!e.redeem.output.equals(t))throw new TypeError("Witness and redeem.output mismatch");if(e.witness.some(l)||(o.decompile(t)||[]).some(l))throw new TypeError("Witness contains uncompressed pubkey")}}return Object.assign(w,e)}},9483:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(23215),s=r(31218),o=r(62919),u=r(56406),a=r(48715),c=r(89717),p=r(39247),f=r(51002),h=r(37398),l=r(29386),d=r(36005),w={network:f.bitcoin,maximumFeeRate:5e3};class _{constructor(e={},t=new i.Psbt(new y)){this.data=t,this.opts=Object.assign({},w,e),this.__CACHE={__NON_WITNESS_UTXO_TX_CACHE:[],__NON_WITNESS_UTXO_BUF_CACHE:[],__TX_IN_CACHE:{},__TX:this.data.globalMap.unsignedTx.tx,__UNSAFE_SIGN_NONSEGWIT:!1},0===this.data.inputs.length&&this.setVersion(2);const r=(e,t,r,n)=>Object.defineProperty(e,t,{enumerable:r,writable:n});r(this,"__CACHE",!1,!0),r(this,"opts",!1,!0)}static fromBase64(e,t={}){const r=n.from(e,"base64");return this.fromBuffer(r,t)}static fromHex(e,t={}){const r=n.from(e,"hex");return this.fromBuffer(r,t)}static fromBuffer(e,t={}){const r=i.Psbt.fromBuffer(e,E),n=new _(t,r);var s,o;return s=n.__CACHE.__TX,o=n.__CACHE,s.ins.forEach((e=>{U(o,e)})),n}get inputCount(){return this.data.inputs.length}get version(){return this.__CACHE.__TX.version}set version(e){this.setVersion(e)}get locktime(){return this.__CACHE.__TX.locktime}set locktime(e){this.setLocktime(e)}get txInputs(){return this.__CACHE.__TX.ins.map((e=>({hash:a.cloneBuffer(e.hash),index:e.index,sequence:e.sequence})))}get txOutputs(){return this.__CACHE.__TX.outs.map((e=>{let t;try{t=u.fromOutputScript(e.script,this.opts.network)}catch(r){}return{script:a.cloneBuffer(e.script),value:e.value,address:t}}))}combine(...e){return this.data.combine(...e.map((e=>e.data))),this}clone(){const e=_.fromBuffer(this.data.toBuffer());return e.opts=JSON.parse(JSON.stringify(this.opts)),e}setMaximumFeeRate(e){N(e),this.opts.maximumFeeRate=e}setVersion(e){N(e),L(this.data.inputs,"setVersion");const t=this.__CACHE;return t.__TX.version=e,t.__EXTRACTED_TX=void 0,this}setLocktime(e){N(e),L(this.data.inputs,"setLocktime");const t=this.__CACHE;return t.__TX.locktime=e,t.__EXTRACTED_TX=void 0,this}setInputSequence(e,t){N(t),L(this.data.inputs,"setInputSequence");const r=this.__CACHE;if(r.__TX.ins.length<=e)throw new Error("Input index too high");return r.__TX.ins[e].sequence=t,r.__EXTRACTED_TX=void 0,this}addInputs(e){return e.forEach((e=>this.addInput(e))),this}addInput(e){if(arguments.length>1||!e||void 0===e.hash||void 0===e.index)throw new Error("Invalid arguments for Psbt.addInput. Requires single object with at least [hash] and [index]");L(this.data.inputs,"addInput"),e.witnessScript&&z(e.witnessScript);const t=this.__CACHE;this.data.addInput(e);U(t,t.__TX.ins[t.__TX.ins.length-1]);const r=this.data.inputs.length-1,n=this.data.inputs[r];return n.nonWitnessUtxo&&F(this.__CACHE,n,r),t.__FEE=void 0,t.__FEE_RATE=void 0,t.__EXTRACTED_TX=void 0,this}addOutputs(e){return e.forEach((e=>this.addOutput(e))),this}addOutput(e){if(arguments.length>1||!e||void 0===e.value||void 0===e.address&&void 0===e.script)throw new Error("Invalid arguments for Psbt.addOutput. Requires single object with at least [script or address] and [value]");L(this.data.inputs,"addOutput");const{address:t}=e;if("string"===typeof t){const{network:r}=this.opts,n=u.toOutputScript(t,r);e=Object.assign(e,{script:n})}const r=this.__CACHE;return this.data.addOutput(e),r.__FEE=void 0,r.__FEE_RATE=void 0,r.__EXTRACTED_TX=void 0,this}extractTransaction(e){if(!this.data.inputs.every(S))throw new Error("Not finalized");const t=this.__CACHE;if(e||function(e,t,r){const n=t.__FEE_RATE||e.getFeeRate(),i=t.__EXTRACTED_TX.virtualSize(),s=n*i;if(n>=r.maximumFeeRate)throw new Error(`Warning: You are paying around ${(s/1e8).toFixed(8)} in fees, which is ${n} satoshi per byte for a transaction with a VSize of ${i} bytes (segwit counted as 0.25 byte per byte). Use setMaximumFeeRate method to raise your threshold, or pass true to the first arg of extractTransaction.`)}(this,t,this.opts),t.__EXTRACTED_TX)return t.__EXTRACTED_TX;const r=t.__TX.clone();return Y(this.data.inputs,r,t,!0),r}getFeeRate(){return R("__FEE_RATE","fee rate",this.data.inputs,this.__CACHE)}getFee(){return R("__FEE","fee",this.data.inputs,this.__CACHE)}finalizeAllInputs(){return o.checkForInput(this.data.inputs,0),J(this.data.inputs.length).forEach((e=>this.finalizeInput(e))),this}finalizeInput(e,t=K){const r=o.checkForInput(this.data.inputs,e),{script:n,isP2SH:i,isP2WSH:s,isSegwit:u}=function(e,t,r){const n=r.__TX,i={script:null,isSegwit:!1,isP2SH:!1,isP2WSH:!1};if(i.isP2SH=!!t.redeemScript,i.isP2WSH=!!t.witnessScript,t.witnessScript)i.script=t.witnessScript;else if(t.redeemScript)i.script=t.redeemScript;else if(t.nonWitnessUtxo){const s=j(r,t,e),o=n.ins[e].index;i.script=s.outs[o].script}else t.witnessUtxo&&(i.script=t.witnessUtxo.script);(t.witnessScript||P(i.script))&&(i.isSegwit=!0);return i}(e,r,this.__CACHE);if(!n)throw new Error(`No script found for input #${e}`);!function(e){if(!e.sighashType||!e.partialSig)return;const{partialSig:t,sighashType:r}=e;t.forEach((e=>{const{hashType:t}=l.signature.decode(e.signature);if(r!==t)throw new Error("Signature sighash does not match input sighash type")}))}(r);const{finalScriptSig:a,finalScriptWitness:c}=t(e,r,n,u,i,s);if(a&&this.data.updateInput(e,{finalScriptSig:a}),c&&this.data.updateInput(e,{finalScriptWitness:c}),!a&&!c)throw new Error(`Unknown error finalizing input #${e}`);return this.data.clearFinalizedInput(e),this}getInputType(e){const t=o.checkForInput(this.data.inputs,e),r=$(X(e,t,this.__CACHE),e,"input",t.redeemScript||function(e){if(!e)return;const t=l.decompile(e);if(!t)return;const r=t[t.length-1];if(!n.isBuffer(r)||q(r)||(i=r,l.isCanonicalScriptSignature(i)))return;var i;if(!l.decompile(r))return;return r}(t.finalScriptSig),t.witnessScript||function(e){if(!e)return;const t=W(e),r=t[t.length-1];if(q(r))return;if(!l.decompile(r))return;return r}(t.finalScriptWitness));return("raw"===r.type?"":r.type+"-")+Q(r.meaningfulScript)}inputHasPubkey(e,t){return function(e,t,r,n){const i=X(r,t,n),{meaningfulScript:s}=$(i,r,"input",t.redeemScript,t.witnessScript);return Z(e,s)}(t,o.checkForInput(this.data.inputs,e),e,this.__CACHE)}inputHasHDKey(e,t){const r=o.checkForInput(this.data.inputs,e),n=A(t);return!!r.bip32Derivation&&r.bip32Derivation.some(n)}outputHasPubkey(e,t){return function(e,t,r,n){const i=n.__TX.outs[r].script,{meaningfulScript:s}=$(i,r,"output",t.redeemScript,t.witnessScript);return Z(e,s)}(t,o.checkForOutput(this.data.outputs,e),e,this.__CACHE)}outputHasHDKey(e,t){const r=o.checkForOutput(this.data.outputs,e),n=A(t);return!!r.bip32Derivation&&r.bip32Derivation.some(n)}validateSignaturesOfAllInputs(){o.checkForInput(this.data.inputs,0);return J(this.data.inputs.length).map((e=>this.validateSignaturesOfInput(e))).reduce(((e,t)=>!0===t&&e),!0)}validateSignaturesOfInput(e,t){const r=this.data.inputs[e],n=(r||{}).partialSig;if(!r||!n||n.length<1)throw new Error("No signatures to validate");const i=t?n.filter((e=>e.pubkey.equals(t))):n;if(i.length<1)throw new Error("No signatures for this pubkey");const s=[];let o,u,a;for(const c of i){const t=l.signature.decode(c.signature),{hash:n,script:i}=a!==t.hashType?x(e,Object.assign({},r,{sighashType:t.hashType}),this.__CACHE,!0):{hash:o,script:u};a=t.hashType,o=n,u=i,C(c.pubkey,i,"verify");const f=p.fromPublicKey(c.pubkey);s.push(f.verify(n,t.signature))}return s.every((e=>!0===e))}signAllInputsHD(e,t=[d.Transaction.SIGHASH_ALL]){if(!e||!e.publicKey||!e.fingerprint)throw new Error("Need HDSigner to sign input");const r=[];for(const i of J(this.data.inputs.length))try{this.signInputHD(i,e,t),r.push(!0)}catch(n){r.push(!1)}if(r.every((e=>!1===e)))throw new Error("No inputs were signed");return this}signAllInputsHDAsync(e,t=[d.Transaction.SIGHASH_ALL]){return new Promise(((r,n)=>{if(!e||!e.publicKey||!e.fingerprint)return n(new Error("Need HDSigner to sign input"));const i=[],s=[];for(const o of J(this.data.inputs.length))s.push(this.signInputHDAsync(o,e,t).then((()=>{i.push(!0)}),(()=>{i.push(!1)})));return Promise.all(s).then((()=>{if(i.every((e=>!1===e)))return n(new Error("No inputs were signed"));r()}))}))}signInputHD(e,t,r=[d.Transaction.SIGHASH_ALL]){if(!t||!t.publicKey||!t.fingerprint)throw new Error("Need HDSigner to sign input");return M(e,this.data.inputs,t).forEach((t=>this.signInput(e,t,r))),this}signInputHDAsync(e,t,r=[d.Transaction.SIGHASH_ALL]){return new Promise(((n,i)=>{if(!t||!t.publicKey||!t.fingerprint)return i(new Error("Need HDSigner to sign input"));const s=M(e,this.data.inputs,t).map((t=>this.signInputAsync(e,t,r)));return Promise.all(s).then((()=>{n()})).catch(i)}))}signAllInputs(e,t=[d.Transaction.SIGHASH_ALL]){if(!e||!e.publicKey)throw new Error("Need Signer to sign input");const r=[];for(const i of J(this.data.inputs.length))try{this.signInput(i,e,t),r.push(!0)}catch(n){r.push(!1)}if(r.every((e=>!1===e)))throw new Error("No inputs were signed");return this}signAllInputsAsync(e,t=[d.Transaction.SIGHASH_ALL]){return new Promise(((r,n)=>{if(!e||!e.publicKey)return n(new Error("Need Signer to sign input"));const i=[],s=[];for(const[o]of this.data.inputs.entries())s.push(this.signInputAsync(o,e,t).then((()=>{i.push(!0)}),(()=>{i.push(!1)})));return Promise.all(s).then((()=>{if(i.every((e=>!1===e)))return n(new Error("No inputs were signed"));r()}))}))}signInput(e,t,r=[d.Transaction.SIGHASH_ALL]){if(!t||!t.publicKey)throw new Error("Need Signer to sign input");const{hash:n,sighashType:i}=V(this.data.inputs,e,t.publicKey,this.__CACHE,r),s=[{pubkey:t.publicKey,signature:l.signature.encode(t.sign(n),i)}];return this.data.updateInput(e,{partialSig:s}),this}signInputAsync(e,t,r=[d.Transaction.SIGHASH_ALL]){return Promise.resolve().then((()=>{if(!t||!t.publicKey)throw new Error("Need Signer to sign input");const{hash:n,sighashType:i}=V(this.data.inputs,e,t.publicKey,this.__CACHE,r);return Promise.resolve(t.sign(n)).then((r=>{const n=[{pubkey:t.publicKey,signature:l.signature.encode(r,i)}];this.data.updateInput(e,{partialSig:n})}))}))}toBuffer(){return g(this.__CACHE),this.data.toBuffer()}toHex(){return g(this.__CACHE),this.data.toHex()}toBase64(){return g(this.__CACHE),this.data.toBase64()}updateGlobal(e){return this.data.updateGlobal(e),this}updateInput(e,t){return t.witnessScript&&z(t.witnessScript),this.data.updateInput(e,t),t.nonWitnessUtxo&&F(this.__CACHE,this.data.inputs[e],e),this}updateOutput(e,t){return this.data.updateOutput(e,t),this}addUnknownKeyValToGlobal(e){return this.data.addUnknownKeyValToGlobal(e),this}addUnknownKeyValToInput(e,t){return this.data.addUnknownKeyValToInput(e,t),this}addUnknownKeyValToOutput(e,t){return this.data.addUnknownKeyValToOutput(e,t),this}clearFinalizedInput(e){return this.data.clearFinalizedInput(e),this}}t.Psbt=_;const E=e=>new y(e);class y{constructor(e=n.from([2,0,0,0,0,0,0,0,0,0])){this.tx=d.Transaction.fromBuffer(e),function(e){if(!e.ins.every((e=>e.script&&0===e.script.length&&e.witness&&0===e.witness.length)))throw new Error("Format Error: Transaction ScriptSigs are not empty")}(this.tx),Object.defineProperty(this,"tx",{enumerable:!1,writable:!0})}getInputOutputCounts(){return{inputCount:this.tx.ins.length,outputCount:this.tx.outs.length}}addInput(e){if(void 0===e.hash||void 0===e.index||!n.isBuffer(e.hash)&&"string"!==typeof e.hash||"number"!==typeof e.index)throw new Error("Error adding input.");const t="string"===typeof e.hash?a.reverseBuffer(n.from(e.hash,"hex")):e.hash;this.tx.addInput(t,e.index,e.sequence)}addOutput(e){if(void 0===e.script||void 0===e.value||!n.isBuffer(e.script)||"number"!==typeof e.value)throw new Error("Error adding output.");this.tx.addOutput(e.script,e.value)}toBuffer(){return this.tx.toBuffer()}}function g(e){if(!1!==e.__UNSAFE_SIGN_NONSEGWIT)throw new Error("Not BIP174 compliant, can not export")}function I(e,t,r){if(!t)return!1;let n;if(n=r?r.map((e=>{const r=p.fromPublicKey(e,{compressed:!0}).publicKey;return t.find((e=>e.pubkey.equals(r)))})).filter((e=>!!e)):t,n.length>e)throw new Error("Too many signatures");return n.length===e}function S(e){return!!e.finalScriptSig||!!e.finalScriptWitness}function m(e){return t=>{try{return e({output:t}),!0}catch(r){return!1}}}const T=m(h.p2ms),b=m(h.p2pk),v=m(h.p2pkh),P=m(h.p2wpkh),O=m(h.p2wsh),k=m(h.p2sh);function A(e){return t=>!!t.masterFingerprint.equals(e.fingerprint)&&!!e.derivePath(t.path).publicKey.equals(t.pubkey)}function N(e){if("number"!==typeof e||e!==Math.floor(e)||e>4294967295||e<0)throw new Error("Invalid 32 bit integer")}function L(e,t){e.forEach((e=>{let r=!1,i=[];if(0===(e.partialSig||[]).length){if(!e.finalScriptSig&&!e.finalScriptWitness)return;i=function(e){const t=e.finalScriptSig&&l.decompile(e.finalScriptSig)||[],r=e.finalScriptWitness&&l.decompile(e.finalScriptWitness)||[];return t.concat(r).filter((e=>n.isBuffer(e)&&l.isCanonicalScriptSignature(e))).map((e=>({signature:e})))}(e)}else i=e.partialSig;if(i.forEach((e=>{const{hashType:n}=l.signature.decode(e.signature),i=[];n&d.Transaction.SIGHASH_ANYONECANPAY&&i.push("addInput");switch(31&n){case d.Transaction.SIGHASH_ALL:break;case d.Transaction.SIGHASH_SINGLE:case d.Transaction.SIGHASH_NONE:i.push("addOutput"),i.push("setInputSequence")}-1===i.indexOf(t)&&(r=!0)})),r)throw new Error("Can not modify transaction, signatures exist.")}))}function C(e,t,r){if(!Z(e,t))throw new Error(`Can not ${r} for this input with the key ${e.toString("hex")}`)}function U(e,t){const r=a.reverseBuffer(n.from(t.hash)).toString("hex")+":"+t.index;if(e.__TX_IN_CACHE[r])throw new Error("Duplicate input detected.");e.__TX_IN_CACHE[r]=1}function B(e,t){return(r,n,i,s)=>{const o=e({redeem:{output:i}}).output;if(!n.equals(o))throw new Error(`${t} for ${s} #${r} doesn't match the scriptPubKey in the prevout`)}}const H=B(h.p2sh,"Redeem script"),D=B(h.p2wsh,"Witness script");function R(e,t,r,n){if(!r.every(S))throw new Error(`PSBT must be finalized to calculate ${t}`);if("__FEE_RATE"===e&&n.__FEE_RATE)return n.__FEE_RATE;if("__FEE"===e&&n.__FEE)return n.__FEE;let i,s=!0;return n.__EXTRACTED_TX?(i=n.__EXTRACTED_TX,s=!1):i=n.__TX.clone(),Y(r,i,n,s),"__FEE_RATE"===e?n.__FEE_RATE:"__FEE"===e?n.__FEE:void 0}function K(e,t,r,n,i,s){const o=Q(r);if(!function(e,t,r){switch(r){case"pubkey":case"pubkeyhash":case"witnesspubkeyhash":return I(1,e.partialSig);case"multisig":const r=h.p2ms({output:t});return I(r.m,e.partialSig,r.pubkeys);default:return!1}}(t,r,o))throw new Error(`Can not finalize input #${e}`);return function(e,t,r,n,i,s){let o,u;const a=function(e,t,r){let n;switch(t){case"multisig":const t=function(e,t){return h.p2ms({output:e}).pubkeys.map((e=>(t.filter((t=>t.pubkey.equals(e)))[0]||{}).signature)).filter((e=>!!e))}(e,r);n=h.p2ms({output:e,signatures:t});break;case"pubkey":n=h.p2pk({output:e,signature:r[0].signature});break;case"pubkeyhash":n=h.p2pkh({output:e,pubkey:r[0].pubkey,signature:r[0].signature});break;case"witnesspubkeyhash":n=h.p2wpkh({output:e,pubkey:r[0].pubkey,signature:r[0].signature})}return n}(e,t,r),c=s?h.p2wsh({redeem:a}):null,p=i?h.p2sh({redeem:c||a}):null;n?(u=G(c?c.witness:a.witness),p&&(o=p.input)):o=p?p.input:a.input;return{finalScriptSig:o,finalScriptWitness:u}}(r,o,t.partialSig,n,i,s)}function V(e,t,r,n,i){const s=o.checkForInput(e,t),{hash:u,sighashType:a,script:c}=x(t,s,n,!1,i);return C(r,c,"sign"),{hash:u,sighashType:a}}function x(e,t,r,n,i){const s=r.__TX,o=t.sighashType||d.Transaction.SIGHASH_ALL;if(i&&i.indexOf(o)<0){const e=function(e){let t=e&d.Transaction.SIGHASH_ANYONECANPAY?"SIGHASH_ANYONECANPAY | ":"";switch(31&e){case d.Transaction.SIGHASH_ALL:t+="SIGHASH_ALL";break;case d.Transaction.SIGHASH_SINGLE:t+="SIGHASH_SINGLE";break;case d.Transaction.SIGHASH_NONE:t+="SIGHASH_NONE"}return t}(o);throw new Error(`Sighash type is not allowed. Retry the sign method passing the sighashTypes array of whitelisted types. Sighash type: ${e}`)}let u,a;if(t.nonWitnessUtxo){const n=j(r,t,e),i=s.ins[e].hash,o=n.getHash();if(!i.equals(o))throw new Error(`Non-witness UTXO hash for input #${e} doesn't match the hash specified in the prevout`);const u=s.ins[e].index;a=n.outs[u]}else{if(!t.witnessUtxo)throw new Error("Need a Utxo input item for signing");a=t.witnessUtxo}const{meaningfulScript:c,type:p}=$(a.script,e,"input",t.redeemScript,t.witnessScript);if(["p2sh-p2wsh","p2wsh"].indexOf(p)>=0)u=s.hashForWitnessV0(e,c,a.value,o);else if(P(c)){const t=h.p2pkh({hash:c.slice(2)}).output;u=s.hashForWitnessV0(e,t,a.value,o)}else{if(void 0===t.nonWitnessUtxo&&!1===r.__UNSAFE_SIGN_NONSEGWIT)throw new Error(`Input #${e} has witnessUtxo but non-segwit script: ${c.toString("hex")}`);n||!1===r.__UNSAFE_SIGN_NONSEGWIT||console.warn("Warning: Signing non-segwit inputs without the full parent transaction means there is a chance that a miner could feed you incorrect information to trick you into paying large fees. This behavior is the same as the old TransactionBuilder class when signing non-segwit scripts. You are not able to export this Psbt with toBuffer|toBase64|toHex since it is not BIP174 compliant.\n*********************\nPROCEED WITH CAUTION!\n*********************"),u=s.hashForSignature(e,c,o)}return{script:c,sighashType:o,hash:u}}function M(e,t,r){const n=o.checkForInput(t,e);if(!n.bip32Derivation||0===n.bip32Derivation.length)throw new Error("Need bip32Derivation to sign with HD");const i=n.bip32Derivation.map((e=>e.masterFingerprint.equals(r.fingerprint)?e:void 0)).filter((e=>!!e));if(0===i.length)throw new Error("Need one bip32Derivation masterFingerprint to match the HDSigner fingerprint");return i.map((e=>{const t=r.derivePath(e.path);if(!e.pubkey.equals(t.publicKey))throw new Error("pubkey did not match bip32Derivation");return t}))}function W(e){let t=0;function r(){const r=s.decode(e,t);return t+=s.decode.bytes,r}function n(){return n=r(),t+=n,e.slice(t-n,t);var n}return function(){const e=r(),t=[];for(let r=0;r<e;r++)t.push(n());return t}()}function G(e){let t=n.allocUnsafe(0);function r(e){const r=t.length,i=s.encodingLength(e);t=n.concat([t,n.allocUnsafe(i)]),s.encode(e,t,r)}function i(e){r(e.length),function(e){t=n.concat([t,n.from(e)])}(e)}var o;return r((o=e).length),o.forEach(i),t}function F(e,t,r){e.__NON_WITNESS_UTXO_BUF_CACHE[r]=t.nonWitnessUtxo;const n=d.Transaction.fromBuffer(t.nonWitnessUtxo);e.__NON_WITNESS_UTXO_TX_CACHE[r]=n;const i=e,s=r;delete t.nonWitnessUtxo,Object.defineProperty(t,"nonWitnessUtxo",{enumerable:!0,get(){const e=i.__NON_WITNESS_UTXO_BUF_CACHE[s],t=i.__NON_WITNESS_UTXO_TX_CACHE[s];if(void 0!==e)return e;{const e=t.toBuffer();return i.__NON_WITNESS_UTXO_BUF_CACHE[s]=e,e}},set(e){i.__NON_WITNESS_UTXO_BUF_CACHE[s]=e}})}function Y(e,t,r,n){let i=0;e.forEach(((e,s)=>{if(n&&e.finalScriptSig&&(t.ins[s].script=e.finalScriptSig),n&&e.finalScriptWitness&&(t.ins[s].witness=W(e.finalScriptWitness)),e.witnessUtxo)i+=e.witnessUtxo.value;else if(e.nonWitnessUtxo){const n=j(r,e,s),o=t.ins[s].index,u=n.outs[o];i+=u.value}}));const s=t.outs.reduce(((e,t)=>e+t.value),0),o=i-s;if(o<0)throw new Error("Outputs are spending more than Inputs");const u=t.virtualSize();r.__FEE=o,r.__EXTRACTED_TX=t,r.__FEE_RATE=Math.floor(o/u)}function j(e,t,r){const n=e.__NON_WITNESS_UTXO_TX_CACHE;return n[r]||F(e,t,r),n[r]}function X(e,t,r){if(void 0!==t.witnessUtxo)return t.witnessUtxo.script;if(void 0!==t.nonWitnessUtxo){return j(r,t,e).outs[r.__TX.ins[e].index].script}throw new Error("Can't find pubkey in input without Utxo data")}function q(e){return 33===e.length&&l.isCanonicalPubKey(e)}function $(e,t,r,n,i){const s=k(e),o=s&&n&&O(n),u=O(e);if(s&&void 0===n)throw new Error("scriptPubkey is P2SH but redeemScript missing");if((u||o)&&void 0===i)throw new Error("scriptPubkey or redeemScript is P2WSH but witnessScript missing");let a;return o?(a=i,H(t,e,n,r),D(t,n,i,r),z(a)):u?(a=i,D(t,e,i,r),z(a)):s?(a=n,H(t,e,n,r)):a=e,{meaningfulScript:a,type:o?"p2sh-p2wsh":s?"p2sh":u?"p2wsh":"raw"}}function z(e){if(P(e)||k(e))throw new Error("P2WPKH or P2SH can not be contained within P2WSH")}function Z(e,t){const r=c.hash160(e),n=l.decompile(t);if(null===n)throw new Error("Unknown script error");return n.some((t=>"number"!==typeof t&&(t.equals(e)||t.equals(r))))}function Q(e){return P(e)?"witnesspubkeyhash":v(e)?"pubkeyhash":T(e)?"multisig":b(e)?"pubkey":"nonstandard"}function J(e){return[...Array(e).keys()]}},29386:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(48254),s=r(14771),o=r(99455),u=r(19443),a=r(8674),c=r(27884),p=r(41569);t.OPS=r(39991);const f=r(92056),h=t.OPS.OP_RESERVED;function l(e){return o.Buffer(e)||function(e){return o.Number(e)&&(e===t.OPS.OP_0||e>=t.OPS.OP_1&&e<=t.OPS.OP_16||e===t.OPS.OP_1NEGATE)}(e)}function d(e){return o.Array(e)&&e.every(l)}function w(e){return 0===e.length?t.OPS.OP_0:1===e.length?e[0]>=1&&e[0]<=16?h+e[0]:129===e[0]?t.OPS.OP_1NEGATE:void 0:void 0}function _(e){return n.isBuffer(e)}function E(e){return n.isBuffer(e)}function y(e){if(_(e))return e;p(o.Array,e);const t=e.reduce(((e,t)=>E(t)?1===t.length&&void 0!==w(t)?e+1:e+c.encodingLength(t.length)+t.length:e+1),0),r=n.allocUnsafe(t);let i=0;if(e.forEach((e=>{if(E(e)){const t=w(e);if(void 0!==t)return r.writeUInt8(t,i),void(i+=1);i+=c.encode(r,e.length,i),e.copy(r,i),i+=e.length}else r.writeUInt8(e,i),i+=1})),i!==r.length)throw new Error("Could not decode chunks");return r}function g(e){if(r=e,o.Array(r))return e;var r;p(o.Buffer,e);const n=[];let i=0;for(;i<e.length;){const r=e[i];if(r>t.OPS.OP_0&&r<=t.OPS.OP_PUSHDATA4){const t=c.decode(e,i);if(null===t)return null;if(i+=t.size,i+t.number>e.length)return null;const r=e.slice(i,i+t.number);i+=t.number;const s=w(r);void 0!==s?n.push(s):n.push(r)}else n.push(r),i+=1}return n}function I(e){const t=-129&e;return t>0&&t<4}t.isPushOnly=d,t.compile=y,t.decompile=g,t.toASM=function(e){return _(e)&&(e=g(e)),e.map((e=>{if(E(e)){const t=w(e);if(void 0===t)return e.toString("hex");e=t}return f[e]})).join(" ")},t.fromASM=function(e){return p(o.String,e),y(e.split(" ").map((e=>void 0!==t.OPS[e]?t.OPS[e]:(p(o.Hex,e),n.from(e,"hex")))))},t.toStack=function(e){return e=g(e),p(d,e),e.map((e=>E(e)?e:e===t.OPS.OP_0?n.allocUnsafe(0):i.encode(e-h)))},t.isCanonicalPubKey=function(e){return a.isPoint(e)},t.isDefinedHashType=I,t.isCanonicalScriptSignature=function(e){return!!n.isBuffer(e)&&(!!I(e[e.length-1])&&u.check(e.slice(0,-1)))},t.number=i,t.signature=s},48254:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.decode=function(e,t,r){t=t||4,r=void 0===r||r;const n=e.length;if(0===n)return 0;if(n>t)throw new TypeError("Script number overflow");if(r&&0===(127&e[n-1])&&(n<=1||0===(128&e[n-2])))throw new Error("Non-minimally encoded script number");if(5===n){const t=e.readUInt32LE(0),r=e.readUInt8(4);return 128&r?-(4294967296*(-129&r)+t):4294967296*r+t}let i=0;for(let s=0;s<n;++s)i|=e[s]<<8*s;return 128&e[n-1]?-(i&~(128<<8*(n-1))):i},t.encode=function(e){let t=Math.abs(e);const r=(i=t)>2147483647?5:i>8388607?4:i>32767?3:i>127?2:i>0?1:0;var i;const s=n.allocUnsafe(r),o=e<0;for(let n=0;n<r;++n)s.writeUInt8(255&t,n),t>>=8;return 128&s[r-1]?s.writeUInt8(o?128:0,r-1):o&&(s[r-1]|=128),s}},14771:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(99455),s=r(19443),o=r(41569),u=n.alloc(1,0);function a(e){let t=0;for(;0===e[t];)++t;return t===e.length?u:128&(e=e.slice(t))[0]?n.concat([u,e],1+e.length):e}function c(e){0===e[0]&&(e=e.slice(1));const t=n.alloc(32,0),r=Math.max(0,32-e.length);return e.copy(t,r),t}t.decode=function(e){const t=e.readUInt8(e.length-1),r=-129&t;if(r<=0||r>=4)throw new Error("Invalid hashType "+t);const i=s.decode(e.slice(0,-1)),o=c(i.r),u=c(i.s);return{signature:n.concat([o,u],64),hashType:t}},t.encode=function(e,t){o({signature:i.BufferN(64),hashType:i.UInt8},{signature:e,hashType:t});const r=-129&t;if(r<=0||r>=4)throw new Error("Invalid hashType "+t);const u=n.allocUnsafe(1);u.writeUInt8(t,0);const c=a(e.slice(0,32)),p=a(e.slice(32,64));return n.concat([s.encode(c,p),u])}},89811:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(41057);t.input=n;const i=r(6280);t.output=i},41057:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(29386),i=r(29386);function s(e){return e===i.OPS.OP_0||n.isCanonicalScriptSignature(e)}function o(e,t){const r=n.decompile(e);return!(r.length<2)&&(r[0]===i.OPS.OP_0&&(t?r.slice(1).every(s):r.slice(1).every(n.isCanonicalScriptSignature)))}t.check=o,o.toJSON=()=>"multisig input"},6280:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(29386),i=r(29386),s=r(99455),o=i.OPS.OP_RESERVED;function u(e,t){const r=n.decompile(e);if(r.length<4)return!1;if(r[r.length-1]!==i.OPS.OP_CHECKMULTISIG)return!1;if(!s.Number(r[0]))return!1;if(!s.Number(r[r.length-2]))return!1;const u=r[0]-o,a=r[r.length-2]-o;if(u<=0)return!1;if(a>16)return!1;if(u>a)return!1;if(a!==r.length-3)return!1;if(t)return!0;return r.slice(1,-2).every(n.isCanonicalPubKey)}t.check=u,u.toJSON=()=>"multi-sig output"},97776:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(29386),i=n.OPS;function s(e){const t=n.compile(e);return t.length>1&&t[0]===i.OP_RETURN}t.check=s,s.toJSON=()=>"null data output";const o={check:s};t.output=o},24765:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(7203);t.input=n;const i=r(80191);t.output=i},7203:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(29386);function i(e){const t=n.decompile(e);return 1===t.length&&n.isCanonicalScriptSignature(t[0])}t.check=i,i.toJSON=()=>"pubKey input"},80191:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(29386),i=r(29386);function s(e){const t=n.decompile(e);return 2===t.length&&n.isCanonicalPubKey(t[0])&&t[1]===i.OPS.OP_CHECKSIG}t.check=s,s.toJSON=()=>"pubKey output"},36471:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(95298);t.input=n;const i=r(70851);t.output=i},95298:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(29386);function i(e){const t=n.decompile(e);return 2===t.length&&n.isCanonicalScriptSignature(t[0])&&n.isCanonicalPubKey(t[1])}t.check=i,i.toJSON=()=>"pubKeyHash input"},70851:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(29386),i=r(29386);function s(e){const t=n.compile(e);return 25===t.length&&t[0]===i.OPS.OP_DUP&&t[1]===i.OPS.OP_HASH160&&20===t[2]&&t[23]===i.OPS.OP_EQUALVERIFY&&t[24]===i.OPS.OP_CHECKSIG}t.check=s,s.toJSON=()=>"pubKeyHash output"},96387:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(62995);t.input=n;const i=r(71778);t.output=i},62995:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(29386),s=r(89811),o=r(24765),u=r(36471),a=r(24641),c=r(50561);function p(e,t){const r=i.decompile(e);if(r.length<1)return!1;const p=r[r.length-1];if(!n.isBuffer(p))return!1;const f=i.decompile(i.compile(r.slice(0,-1))),h=i.decompile(p);return!!h&&(!!i.isPushOnly(f)&&(1===r.length?c.check(h)||a.check(h):!(!u.input.check(f)||!u.output.check(h))||(!(!s.input.check(f,t)||!s.output.check(h))||!(!o.input.check(f)||!o.output.check(h)))))}t.check=p,p.toJSON=()=>"scriptHash input"},71778:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(29386),i=r(29386);function s(e){const t=n.compile(e);return 23===t.length&&t[0]===i.OPS.OP_HASH160&&20===t[1]&&t[22]===i.OPS.OP_EQUAL}t.check=s,s.toJSON=()=>"scriptHash output"},67980:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(45704);t.output=n},45704:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(29386),s=r(29386),o=r(99455),u=r(41569),a=n.from("aa21a9ed","hex");function c(e){const t=i.compile(e);return t.length>37&&t[0]===s.OPS.OP_RETURN&&36===t[1]&&t.slice(2,6).equals(a)}t.check=c,c.toJSON=()=>"Witness commitment output",t.encode=function(e){u(o.Hash256bit,e);const t=n.allocUnsafe(36);return a.copy(t,0),e.copy(t,4),i.compile([s.OPS.OP_RETURN,t])},t.decode=function(e){return u(c,e),i.decompile(e)[1].slice(4,36)}},78229:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(86353);t.input=n;const i=r(24641);t.output=i},86353:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(29386);function i(e){const t=n.decompile(e);return 2===t.length&&n.isCanonicalScriptSignature(t[0])&&(r=t[1],n.isCanonicalPubKey(r)&&33===r.length);var r}t.check=i,i.toJSON=()=>"witnessPubKeyHash input"},24641:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(29386),i=r(29386);function s(e){const t=n.compile(e);return 22===t.length&&t[0]===i.OPS.OP_0&&20===t[1]}t.check=s,s.toJSON=()=>"Witness pubKeyHash output"},22789:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(48837);t.input=n;const i=r(50561);t.output=i},48837:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(29386),s=r(41569),o=r(89811),u=r(24765),a=r(36471);function c(e,t){if(s(s.Array,e),e.length<1)return!1;const r=e[e.length-1];if(!n.isBuffer(r))return!1;const c=i.decompile(r);if(!c||0===c.length)return!1;const p=i.compile(e.slice(0,-1));return!(!a.input.check(p)||!a.output.check(c))||(!(!o.input.check(p,t)||!o.output.check(c))||!(!u.input.check(p)||!u.output.check(c)))}t.check=c,c.toJSON=()=>"witnessScriptHash input"},50561:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(29386),i=r(29386);function s(e){const t=n.compile(e);return 34===t.length&&t[0]===i.OPS.OP_0&&32===t[1]}t.check=s,s.toJSON=()=>"Witness scriptHash output"},36005:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(48715),s=r(89717),o=r(29386),u=r(29386),a=r(99455),c=r(41569),p=r(52941);function f(e){const t=e.length;return p.encodingLength(t)+t}const h=n.allocUnsafe(0),l=[],d=n.from("0000000000000000000000000000000000000000000000000000000000000000","hex"),w=n.from("0000000000000000000000000000000000000000000000000000000000000001","hex"),_=n.from("ffffffffffffffff","hex"),E={script:h,valueBuffer:_};class y{constructor(){this.version=1,this.locktime=0,this.ins=[],this.outs=[]}static fromBuffer(e,t){const r=new i.BufferReader(e),n=new y;n.version=r.readInt32();const s=r.readUInt8(),o=r.readUInt8();let u=!1;s===y.ADVANCED_TRANSACTION_MARKER&&o===y.ADVANCED_TRANSACTION_FLAG?u=!0:r.offset-=2;const a=r.readVarInt();for(let i=0;i<a;++i)n.ins.push({hash:r.readSlice(32),index:r.readUInt32(),script:r.readVarSlice(),sequence:r.readUInt32(),witness:l});const c=r.readVarInt();for(let i=0;i<c;++i)n.outs.push({value:r.readUInt64(),script:r.readVarSlice()});if(u){for(let e=0;e<a;++e)n.ins[e].witness=r.readVector();if(!n.hasWitnesses())throw new Error("Transaction has superfluous witness data")}if(n.locktime=r.readUInt32(),t)return n;if(r.offset!==e.length)throw new Error("Transaction has unexpected data");return n}static fromHex(e){return y.fromBuffer(n.from(e,"hex"),!1)}static isCoinbaseHash(e){c(a.Hash256bit,e);for(let t=0;t<32;++t)if(0!==e[t])return!1;return!0}isCoinbase(){return 1===this.ins.length&&y.isCoinbaseHash(this.ins[0].hash)}addInput(e,t,r,n){return c(a.tuple(a.Hash256bit,a.UInt32,a.maybe(a.UInt32),a.maybe(a.Buffer)),arguments),a.Null(r)&&(r=y.DEFAULT_SEQUENCE),this.ins.push({hash:e,index:t,script:n||h,sequence:r,witness:l})-1}addOutput(e,t){return c(a.tuple(a.Buffer,a.Satoshi),arguments),this.outs.push({script:e,value:t})-1}hasWitnesses(){return this.ins.some((e=>0!==e.witness.length))}weight(){return 3*this.byteLength(!1)+this.byteLength(!0)}virtualSize(){return Math.ceil(this.weight()/4)}byteLength(e=!0){const t=e&&this.hasWitnesses();return(t?10:8)+p.encodingLength(this.ins.length)+p.encodingLength(this.outs.length)+this.ins.reduce(((e,t)=>e+40+f(t.script)),0)+this.outs.reduce(((e,t)=>e+8+f(t.script)),0)+(t?this.ins.reduce(((e,t)=>e+function(e){const t=e.length;return p.encodingLength(t)+e.reduce(((e,t)=>e+f(t)),0)}(t.witness)),0):0)}clone(){const e=new y;return e.version=this.version,e.locktime=this.locktime,e.ins=this.ins.map((e=>({hash:e.hash,index:e.index,script:e.script,sequence:e.sequence,witness:e.witness}))),e.outs=this.outs.map((e=>({script:e.script,value:e.value}))),e}hashForSignature(e,t,r){if(c(a.tuple(a.UInt32,a.Buffer,a.Number),arguments),e>=this.ins.length)return w;const i=o.compile(o.decompile(t).filter((e=>e!==u.OPS.OP_CODESEPARATOR))),p=this.clone();if((31&r)===y.SIGHASH_NONE)p.outs=[],p.ins.forEach(((t,r)=>{r!==e&&(t.sequence=0)}));else if((31&r)===y.SIGHASH_SINGLE){if(e>=this.outs.length)return w;p.outs.length=e+1;for(let t=0;t<e;t++)p.outs[t]=E;p.ins.forEach(((t,r)=>{r!==e&&(t.sequence=0)}))}r&y.SIGHASH_ANYONECANPAY?(p.ins=[p.ins[e]],p.ins[0].script=i):(p.ins.forEach((e=>{e.script=h})),p.ins[e].script=i);const f=n.allocUnsafe(p.byteLength(!1)+4);return f.writeInt32LE(r,f.length-4),p.__toBuffer(f,0,!1),s.hash256(f)}hashForWitnessV0(e,t,r,o){c(a.tuple(a.UInt32,a.Buffer,a.Satoshi,a.UInt32),arguments);let u,p=n.from([]),h=d,l=d,w=d;if(o&y.SIGHASH_ANYONECANPAY||(p=n.allocUnsafe(36*this.ins.length),u=new i.BufferWriter(p,0),this.ins.forEach((e=>{u.writeSlice(e.hash),u.writeUInt32(e.index)})),l=s.hash256(p)),o&y.SIGHASH_ANYONECANPAY||(31&o)===y.SIGHASH_SINGLE||(31&o)===y.SIGHASH_NONE||(p=n.allocUnsafe(4*this.ins.length),u=new i.BufferWriter(p,0),this.ins.forEach((e=>{u.writeUInt32(e.sequence)})),w=s.hash256(p)),(31&o)!==y.SIGHASH_SINGLE&&(31&o)!==y.SIGHASH_NONE){const e=this.outs.reduce(((e,t)=>e+8+f(t.script)),0);p=n.allocUnsafe(e),u=new i.BufferWriter(p,0),this.outs.forEach((e=>{u.writeUInt64(e.value),u.writeVarSlice(e.script)})),h=s.hash256(p)}else if((31&o)===y.SIGHASH_SINGLE&&e<this.outs.length){const t=this.outs[e];p=n.allocUnsafe(8+f(t.script)),u=new i.BufferWriter(p,0),u.writeUInt64(t.value),u.writeVarSlice(t.script),h=s.hash256(p)}p=n.allocUnsafe(156+f(t)),u=new i.BufferWriter(p,0);const _=this.ins[e];return u.writeUInt32(this.version),u.writeSlice(l),u.writeSlice(w),u.writeSlice(_.hash),u.writeUInt32(_.index),u.writeVarSlice(t),u.writeUInt64(r),u.writeUInt32(_.sequence),u.writeSlice(h),u.writeUInt32(this.locktime),u.writeUInt32(o),s.hash256(p)}getHash(e){return e&&this.isCoinbase()?n.alloc(32,0):s.hash256(this.__toBuffer(void 0,void 0,e))}getId(){return i.reverseBuffer(this.getHash(!1)).toString("hex")}toBuffer(e,t){return this.__toBuffer(e,t,!0)}toHex(){return this.toBuffer(void 0,void 0).toString("hex")}setInputScript(e,t){c(a.tuple(a.Number,a.Buffer),arguments),this.ins[e].script=t}setWitness(e,t){c(a.tuple(a.Number,[a.Buffer]),arguments),this.ins[e].witness=t}__toBuffer(e,t,r=!1){e||(e=n.allocUnsafe(this.byteLength(r)));const s=new i.BufferWriter(e,t||0);s.writeInt32(this.version);const o=r&&this.hasWitnesses();return o&&(s.writeUInt8(y.ADVANCED_TRANSACTION_MARKER),s.writeUInt8(y.ADVANCED_TRANSACTION_FLAG)),s.writeVarInt(this.ins.length),this.ins.forEach((e=>{s.writeSlice(e.hash),s.writeUInt32(e.index),s.writeVarSlice(e.script),s.writeUInt32(e.sequence)})),s.writeVarInt(this.outs.length),this.outs.forEach((e=>{void 0!==e.value?s.writeUInt64(e.value):s.writeSlice(e.valueBuffer),s.writeVarSlice(e.script)})),o&&this.ins.forEach((e=>{s.writeVector(e.witness)})),s.writeUInt32(this.locktime),void 0!==t?e.slice(t,s.offset):e}}y.DEFAULT_SEQUENCE=4294967295,y.SIGHASH_ALL=1,y.SIGHASH_NONE=2,y.SIGHASH_SINGLE=3,y.SIGHASH_ANYONECANPAY=128,y.ADVANCED_TRANSACTION_MARKER=0,y.ADVANCED_TRANSACTION_FLAG=1,t.Transaction=y},89765:function(e,t,r){"use strict";var n=r(46785).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(56406),s=r(48715),o=r(53737),u=r(89717),a=r(39247),c=r(51002),p=r(37398),f=r(29386),h=r(29386),l=r(36005),d=r(99455),w=r(41569),_=o.types,E=new Set(["p2pkh","p2pk","p2wpkh","p2ms","p2sh-p2pkh","p2sh-p2pk","p2sh-p2wpkh","p2sh-p2ms","p2wsh-p2pkh","p2wsh-p2pk","p2wsh-p2ms","p2sh-p2wsh-p2pkh","p2sh-p2wsh-p2pk","p2sh-p2wsh-p2ms"]);function y(e,t,r){try{w(e,t)}catch(n){throw new Error(r)}}class g{constructor(e=c.bitcoin,t=2500){this.network=e,this.maximumFeeRate=t,this.__PREV_TX_SET={},this.__INPUTS=[],this.__TX=new l.Transaction,this.__TX.version=2,this.__USE_LOW_R=!1,console.warn("Deprecation Warning: TransactionBuilder will be removed in the future. (v6.x.x or later) Please use the Psbt class instead. Examples of usage are available in the transactions-psbt.js integration test file on our Github. A high level explanation is available in the psbt.ts and psbt.js files as well.")}static fromTransaction(e,t){const r=new g(t);return r.setVersion(e.version),r.setLockTime(e.locktime),e.outs.forEach((e=>{r.addOutput(e.script,e.value)})),e.ins.forEach((e=>{r.__addInputUnsafe(e.hash,e.index,{sequence:e.sequence,script:e.script,witness:e.witness})})),r.__INPUTS.forEach(((t,r)=>{!function(e,t,r){if(e.redeemScriptType!==_.P2MS||!e.redeemScript)return;if(e.pubkeys.length===e.signatures.length)return;const n=e.signatures.concat();e.signatures=e.pubkeys.map((i=>{const s=a.fromPublicKey(i);let o;return n.some(((i,u)=>{if(!i)return!1;const a=f.signature.decode(i),c=t.hashForSignature(r,e.redeemScript,a.hashType);return!!s.verify(c,a.signature)&&(n[u]=void 0,o=i,!0)})),o}))}(t,e,r)})),r}setLowR(e){return w(w.maybe(w.Boolean),e),void 0===e&&(e=!0),this.__USE_LOW_R=e,e}setLockTime(e){if(w(d.UInt32,e),this.__INPUTS.some((e=>!!e.signatures&&e.signatures.some((e=>void 0!==e)))))throw new Error("No, this would invalidate signatures");this.__TX.locktime=e}setVersion(e){w(d.UInt32,e),this.__TX.version=e}addInput(e,t,r,i){if(!this.__canModifyInputs())throw new Error("No, this would invalidate signatures");let o;if("string"===typeof(u=e)||u instanceof String)e=s.reverseBuffer(n.from(e,"hex"));else if(function(e){return e instanceof l.Transaction}(e)){const r=e.outs[t];i=r.script,o=r.value,e=e.getHash(!1)}var u;return this.__addInputUnsafe(e,t,{sequence:r,prevOutScript:i,value:o})}addOutput(e,t){if(!this.__canModifyOutputs())throw new Error("No, this would invalidate signatures");return"string"===typeof e&&(e=i.toOutputScript(e,this.network)),this.__TX.addOutput(e,t)}build(){return this.__build(!1)}buildIncomplete(){return this.__build(!0)}sign(e,t,r,n,i,s){!function({input:e,ourPubKey:t,keyPair:r,signatureHash:n,hashType:i,useLowR:s}){let o=!1;for(const[u,a]of e.pubkeys.entries()){if(!t.equals(a))continue;if(e.signatures[u])throw new Error("Signature already exists");if(33!==t.length&&e.hasWitness)throw new Error("BIP143 rejects uncompressed public keys in P2WPKH or P2WSH");const c=r.sign(n,s);e.signatures[u]=f.signature.encode(c,i),o=!0}if(!o)throw new Error("Key pair cannot sign for this input")}(function(e,t,r,n,i,s,o,u,a,c,h){let g;if("number"===typeof i)console.warn("DEPRECATED: TransactionBuilder sign method arguments will change in v6, please use the TxbSignArg interface"),g=i;else{if("object"!==typeof i)throw new TypeError("TransactionBuilder sign first arg must be TxbSignArg or number");!function(e,t){if(!E.has(t.prevOutScriptType))throw new TypeError(`Unknown prevOutScriptType "${t.prevOutScriptType}"`);y(w.Number,t.vin,"sign must include vin parameter as Number (input index)"),y(d.Signer,t.keyPair,"sign must include keyPair parameter as Signer interface"),y(w.maybe(w.Number),t.hashType,"sign hashType parameter must be a number");const r=(e[t.vin]||[]).prevOutType,n=t.prevOutScriptType;switch(n){case"p2pkh":if(r&&"pubkeyhash"!==r)throw new TypeError(`input #${t.vin} is not of type p2pkh: ${r}`);y(w.value(void 0),t.witnessScript,`${n} requires NO witnessScript`),y(w.value(void 0),t.redeemScript,`${n} requires NO redeemScript`),y(w.value(void 0),t.witnessValue,`${n} requires NO witnessValue`);break;case"p2pk":if(r&&"pubkey"!==r)throw new TypeError(`input #${t.vin} is not of type p2pk: ${r}`);y(w.value(void 0),t.witnessScript,`${n} requires NO witnessScript`),y(w.value(void 0),t.redeemScript,`${n} requires NO redeemScript`),y(w.value(void 0),t.witnessValue,`${n} requires NO witnessValue`);break;case"p2wpkh":if(r&&"witnesspubkeyhash"!==r)throw new TypeError(`input #${t.vin} is not of type p2wpkh: ${r}`);y(w.value(void 0),t.witnessScript,`${n} requires NO witnessScript`),y(w.value(void 0),t.redeemScript,`${n} requires NO redeemScript`),y(d.Satoshi,t.witnessValue,`${n} requires witnessValue`);break;case"p2ms":if(r&&"multisig"!==r)throw new TypeError(`input #${t.vin} is not of type p2ms: ${r}`);y(w.value(void 0),t.witnessScript,`${n} requires NO witnessScript`),y(w.value(void 0),t.redeemScript,`${n} requires NO redeemScript`),y(w.value(void 0),t.witnessValue,`${n} requires NO witnessValue`);break;case"p2sh-p2wpkh":if(r&&"scripthash"!==r)throw new TypeError(`input #${t.vin} is not of type p2sh-p2wpkh: ${r}`);y(w.value(void 0),t.witnessScript,`${n} requires NO witnessScript`),y(w.Buffer,t.redeemScript,`${n} requires redeemScript`),y(d.Satoshi,t.witnessValue,`${n} requires witnessValue`);break;case"p2sh-p2ms":case"p2sh-p2pk":case"p2sh-p2pkh":if(r&&"scripthash"!==r)throw new TypeError(`input #${t.vin} is not of type ${n}: ${r}`);y(w.value(void 0),t.witnessScript,`${n} requires NO witnessScript`),y(w.Buffer,t.redeemScript,`${n} requires redeemScript`),y(w.value(void 0),t.witnessValue,`${n} requires NO witnessValue`);break;case"p2wsh-p2ms":case"p2wsh-p2pk":case"p2wsh-p2pkh":if(r&&"witnessscripthash"!==r)throw new TypeError(`input #${t.vin} is not of type ${n}: ${r}`);y(w.Buffer,t.witnessScript,`${n} requires witnessScript`),y(w.value(void 0),t.redeemScript,`${n} requires NO redeemScript`),y(d.Satoshi,t.witnessValue,`${n} requires witnessValue`);break;case"p2sh-p2wsh-p2ms":case"p2sh-p2wsh-p2pk":case"p2sh-p2wsh-p2pkh":if(r&&"scripthash"!==r)throw new TypeError(`input #${t.vin} is not of type ${n}: ${r}`);y(w.Buffer,t.witnessScript,`${n} requires witnessScript`),y(w.Buffer,t.redeemScript,`${n} requires witnessScript`),y(d.Satoshi,t.witnessValue,`${n} requires witnessScript`)}}(t,i),({vin:g,keyPair:s,redeemScript:o,hashType:u,witnessValue:a,witnessScript:c}=i)}if(void 0===s)throw new Error("sign requires keypair");if(s.network&&s.network!==e)throw new TypeError("Inconsistent network");if(!t[g])throw new Error("No input at index: "+g);if(u=u||l.Transaction.SIGHASH_ALL,r(u))throw new Error("Transaction needs outputs");const I=t[g];if(void 0!==I.redeemScript&&o&&!I.redeemScript.equals(o))throw new Error("Inconsistent redeemScript");const m=s.publicKey||s.getPublicKey&&s.getPublicKey();if(!T(I)){if(void 0!==a){if(void 0!==I.value&&I.value!==a)throw new Error("Input did not match witnessValue");w(d.Satoshi,a),I.value=a}if(!T(I)){const e=function(e,t,r,n){if(r&&n){const i=p.p2wsh({redeem:{output:n}}),s=p.p2wsh({output:r}),o=p.p2sh({redeem:{output:r}}),u=p.p2sh({redeem:i});if(!i.hash.equals(s.hash))throw new Error("Witness script inconsistent with prevOutScript");if(!o.hash.equals(u.hash))throw new Error("Redeem script inconsistent with prevOutScript");const a=S(i.redeem.output,t);if(!a.pubkeys)throw new Error(a.type+" not supported as witnessScript ("+f.toASM(n)+")");e.signatures&&e.signatures.some((e=>void 0!==e))&&(a.signatures=e.signatures);const c=n;if(a.type===_.P2WPKH)throw new Error("P2SH(P2WSH(P2WPKH)) is a consensus failure");return{redeemScript:r,redeemScriptType:_.P2WSH,witnessScript:n,witnessScriptType:a.type,prevOutType:_.P2SH,prevOutScript:o.output,hasWitness:!0,signScript:c,signType:a.type,pubkeys:a.pubkeys,signatures:a.signatures,maxSignatures:a.maxSignatures}}if(r){const n=p.p2sh({redeem:{output:r}});if(e.prevOutScript){let t;try{t=p.p2sh({output:e.prevOutScript})}catch(s){throw new Error("PrevOutScript must be P2SH")}if(!n.hash.equals(t.hash))throw new Error("Redeem script inconsistent with prevOutScript")}const i=S(n.redeem.output,t);if(!i.pubkeys)throw new Error(i.type+" not supported as redeemScript ("+f.toASM(r)+")");e.signatures&&e.signatures.some((e=>void 0!==e))&&(i.signatures=e.signatures);let o=r;return i.type===_.P2WPKH&&(o=p.p2pkh({pubkey:i.pubkeys[0]}).output),{redeemScript:r,redeemScriptType:i.type,prevOutType:_.P2SH,prevOutScript:n.output,hasWitness:i.type===_.P2WPKH,signScript:o,signType:i.type,pubkeys:i.pubkeys,signatures:i.signatures,maxSignatures:i.maxSignatures}}if(n){const r=p.p2wsh({redeem:{output:n}});if(e.prevOutScript){const t=p.p2wsh({output:e.prevOutScript});if(!r.hash.equals(t.hash))throw new Error("Witness script inconsistent with prevOutScript")}const i=S(r.redeem.output,t);if(!i.pubkeys)throw new Error(i.type+" not supported as witnessScript ("+f.toASM(n)+")");e.signatures&&e.signatures.some((e=>void 0!==e))&&(i.signatures=e.signatures);const s=n;if(i.type===_.P2WPKH)throw new Error("P2WSH(P2WPKH) is a consensus failure");return{witnessScript:n,witnessScriptType:i.type,prevOutType:_.P2WSH,prevOutScript:r.output,hasWitness:!0,signScript:s,signType:i.type,pubkeys:i.pubkeys,signatures:i.signatures,maxSignatures:i.maxSignatures}}if(e.prevOutType&&e.prevOutScript){if(e.prevOutType===_.P2SH)throw new Error("PrevOutScript is "+e.prevOutType+", requires redeemScript");if(e.prevOutType===_.P2WSH)throw new Error("PrevOutScript is "+e.prevOutType+", requires witnessScript");if(!e.prevOutScript)throw new Error("PrevOutScript is missing");const r=S(e.prevOutScript,t);if(!r.pubkeys)throw new Error(r.type+" not supported ("+f.toASM(e.prevOutScript)+")");e.signatures&&e.signatures.some((e=>void 0!==e))&&(r.signatures=e.signatures);let n=e.prevOutScript;return r.type===_.P2WPKH&&(n=p.p2pkh({pubkey:r.pubkeys[0]}).output),{prevOutType:r.type,prevOutScript:e.prevOutScript,hasWitness:r.type===_.P2WPKH,signScript:n,signType:r.type,pubkeys:r.pubkeys,signatures:r.signatures,maxSignatures:r.maxSignatures}}const i=p.p2pkh({pubkey:t}).output;return{prevOutType:_.P2PKH,prevOutScript:i,hasWitness:!1,signScript:i,signType:_.P2PKH,pubkeys:[t],signatures:[void 0]}}(I,m,o,c);Object.assign(I,e)}if(!T(I))throw Error(I.prevOutType+" not supported")}let b;b=I.hasWitness?n.hashForWitnessV0(g,I.signScript,I.value,u):n.hashForSignature(g,I.signScript,u);return{input:I,ourPubKey:m,keyPair:s,signatureHash:b,hashType:u,useLowR:!!h}}(this.network,this.__INPUTS,this.__needsOutputs.bind(this),this.__TX,e,t,r,n,i,s,this.__USE_LOW_R))}__addInputUnsafe(e,t,r){if(l.Transaction.isCoinbaseHash(e))throw new Error("coinbase inputs not supported");const n=e.toString("hex")+":"+t;if(void 0!==this.__PREV_TX_SET[n])throw new Error("Duplicate TxOut: "+n);let i={};if(void 0!==r.script&&(i=I(r.script,r.witness||[])),void 0!==r.value&&(i.value=r.value),!i.prevOutScript&&r.prevOutScript){let e;if(!i.pubkeys&&!i.signatures){const t=S(r.prevOutScript);t.pubkeys&&(i.pubkeys=t.pubkeys,i.signatures=t.signatures),e=t.type}i.prevOutScript=r.prevOutScript,i.prevOutType=e||o.output(r.prevOutScript)}const s=this.__TX.addInput(e,t,r.sequence,r.scriptSig);return this.__INPUTS[s]=i,this.__PREV_TX_SET[n]=!0,s}__build(e){if(!e){if(!this.__TX.ins.length)throw new Error("Transaction has no inputs");if(!this.__TX.outs.length)throw new Error("Transaction has no outputs")}const t=this.__TX.clone();if(this.__INPUTS.forEach(((r,n)=>{if(!r.prevOutType&&!e)throw new Error("Transaction is not complete");const i=m(r.prevOutType,r,e);if(i)t.setInputScript(n,i.input),t.setWitness(n,i.witness);else{if(!e&&r.prevOutType===_.NONSTANDARD)throw new Error("Unknown input type");if(!e)throw new Error("Not enough information")}})),!e&&this.__overMaximumFees(t.virtualSize()))throw new Error("Transaction has absurd fees");return t}__canModifyInputs(){return this.__INPUTS.every((e=>!e.signatures||e.signatures.every((e=>{if(!e)return!0;return 0!==(b(e)&l.Transaction.SIGHASH_ANYONECANPAY)}))))}__needsOutputs(e){return e===l.Transaction.SIGHASH_ALL?0===this.__TX.outs.length:0===this.__TX.outs.length&&this.__INPUTS.some((e=>!!e.signatures&&e.signatures.some((e=>{if(!e)return!1;return!(b(e)&l.Transaction.SIGHASH_NONE)}))))}__canModifyOutputs(){const e=this.__TX.ins.length,t=this.__TX.outs.length;return this.__INPUTS.every((r=>void 0===r.signatures||r.signatures.every((r=>{if(!r)return!0;const n=31&b(r);return n===l.Transaction.SIGHASH_NONE||n===l.Transaction.SIGHASH_SINGLE&&e<=t}))))}__overMaximumFees(e){return(this.__INPUTS.reduce(((e,t)=>e+(t.value>>>0)),0)-this.__TX.outs.reduce(((e,t)=>e+t.value),0))/e>this.maximumFeeRate}}function I(e,t,r,n){if(0===e.length&&0===t.length)return{};if(!r){let n=o.input(e,!0),i=o.witness(t,!0);n===_.NONSTANDARD&&(n=void 0),i===_.NONSTANDARD&&(i=void 0),r=n||i}switch(r){case _.P2WPKH:{const{output:e,pubkey:r,signature:n}=p.p2wpkh({witness:t});return{prevOutScript:e,prevOutType:_.P2WPKH,pubkeys:[r],signatures:[n]}}case _.P2PKH:{const{output:t,pubkey:r,signature:n}=p.p2pkh({input:e});return{prevOutScript:t,prevOutType:_.P2PKH,pubkeys:[r],signatures:[n]}}case _.P2PK:{const{signature:t}=p.p2pk({input:e});return{prevOutType:_.P2PK,pubkeys:[void 0],signatures:[t]}}case _.P2MS:{const{m:t,pubkeys:r,signatures:i}=p.p2ms({input:e,output:n},{allowIncomplete:!0});return{prevOutType:_.P2MS,pubkeys:r,signatures:i,maxSignatures:t}}}if(r===_.P2SH){const{output:r,redeem:n}=p.p2sh({input:e,witness:t}),i=o.output(n.output),s=I(n.input,n.witness,i,n.output);return s.prevOutType?{prevOutScript:r,prevOutType:_.P2SH,redeemScript:n.output,redeemScriptType:s.prevOutType,witnessScript:s.witnessScript,witnessScriptType:s.witnessScriptType,pubkeys:s.pubkeys,signatures:s.signatures}:{}}if(r===_.P2WSH){const{output:r,redeem:n}=p.p2wsh({input:e,witness:t}),i=o.output(n.output);let s;return s=i===_.P2WPKH?I(n.input,n.witness,i):I(f.compile(n.witness),[],i,n.output),s.prevOutType?{prevOutScript:r,prevOutType:_.P2WSH,witnessScript:n.output,witnessScriptType:s.prevOutType,pubkeys:s.pubkeys,signatures:s.signatures}:{}}return{prevOutType:_.NONSTANDARD,prevOutScript:e}}function S(e,t){w(d.Buffer,e);const r=o.output(e);switch(r){case _.P2PKH:{if(!t)return{type:r};const n=p.p2pkh({output:e}).hash,i=u.hash160(t);return n.equals(i)?{type:r,pubkeys:[t],signatures:[void 0]}:{type:r}}case _.P2WPKH:{if(!t)return{type:r};const n=p.p2wpkh({output:e}).hash,i=u.hash160(t);return n.equals(i)?{type:r,pubkeys:[t],signatures:[void 0]}:{type:r}}case _.P2PK:return{type:r,pubkeys:[p.p2pk({output:e}).pubkey],signatures:[void 0]};case _.P2MS:{const t=p.p2ms({output:e});return{type:r,pubkeys:t.pubkeys,signatures:t.pubkeys.map((()=>{})),maxSignatures:t.m}}}return{type:r}}function m(e,t,r){const n=t.pubkeys||[];let i=t.signatures||[];switch(e){case _.P2PKH:if(0===n.length)break;if(0===i.length)break;return p.p2pkh({pubkey:n[0],signature:i[0]});case _.P2WPKH:if(0===n.length)break;if(0===i.length)break;return p.p2wpkh({pubkey:n[0],signature:i[0]});case _.P2PK:if(0===n.length)break;if(0===i.length)break;return p.p2pk({signature:i[0]});case _.P2MS:{const e=t.maxSignatures;i=r?i.map((e=>e||h.OPS.OP_0)):i.filter((e=>e));const s=!r||e===i.length;return p.p2ms({m:e,pubkeys:n,signatures:i},{allowIncomplete:r,validate:s})}case _.P2SH:{const e=m(t.redeemScriptType,t,r);if(!e)return;return p.p2sh({redeem:{output:e.output||t.redeemScript,input:e.input,witness:e.witness}})}case _.P2WSH:{const e=m(t.witnessScriptType,t,r);if(!e)return;return p.p2wsh({redeem:{output:t.witnessScript,input:e.input,witness:e.witness}})}}}function T(e){return void 0!==e.signScript&&void 0!==e.signType&&void 0!==e.pubkeys&&void 0!==e.signatures&&e.signatures.length===e.pubkeys.length&&e.pubkeys.length>0&&(!1===e.hasWitness||void 0!==e.value)}function b(e){return e.readUInt8(e.length-1)}t.TransactionBuilder=g},99455:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(41569),i=Math.pow(2,31)-1;function s(e){return n.String(e)&&!!e.match(/^(m\/)?(\d+'?\/)*\d+'?$/)}t.UInt31=function(e){return n.UInt32(e)&&e<=i},t.BIP32Path=s,s.toJSON=()=>"BIP32 derivation path",t.Signer=function(e){return(n.Buffer(e.publicKey)||"function"===typeof e.getPublicKey)&&"function"===typeof e.sign};t.Satoshi=function(e){return n.UInt53(e)&&e<=21e14},t.ECPoint=n.quacksLike("Point"),t.Network=n.compile({messagePrefix:n.oneOf(n.Buffer,n.String),bip32:{public:n.UInt32,private:n.UInt32},pubKeyHash:n.UInt8,scriptHash:n.UInt8,wif:n.UInt8}),t.Buffer256bit=n.BufferN(32),t.Hash160bit=n.BufferN(20),t.Hash256bit=n.BufferN(32),t.Number=n.Number,t.Array=n.Array,t.Boolean=n.Boolean,t.String=n.String,t.Buffer=n.Buffer,t.Hex=n.Hex,t.maybe=n.maybe,t.tuple=n.tuple,t.UInt8=n.UInt8,t.UInt32=n.UInt32,t.Function=n.Function,t.BufferN=n.BufferN,t.Null=n.Null,t.oneOf=n.oneOf},62403:function(e,t,r){var n=r(46785).Buffer;e.exports=function(e,t){if(!Array.isArray(e))throw TypeError("Expected values Array");if("function"!==typeof t)throw TypeError("Expected digest Function");for(var r=e.length,i=e.concat();r>1;){for(var s=0,o=0;o<r;o+=2,++s){var u=i[o],a=o+1===r?u:i[o+1],c=n.concat([u,a]);i[s]=t(c)}r=s}return i[0]}},27884:function(e,t,r){var n=r(39991);function i(e){return e<n.OP_PUSHDATA1?1:e<=255?2:e<=65535?3:5}e.exports={encodingLength:i,encode:function(e,t,r){var s=i(t);return 1===s?e.writeUInt8(t,r):2===s?(e.writeUInt8(n.OP_PUSHDATA1,r),e.writeUInt8(t,r+1)):3===s?(e.writeUInt8(n.OP_PUSHDATA2,r),e.writeUInt16LE(t,r+1)):(e.writeUInt8(n.OP_PUSHDATA4,r),e.writeUInt32LE(t,r+1)),s},decode:function(e,t){var r,i,s=e.readUInt8(t);if(s<n.OP_PUSHDATA1)r=s,i=1;else if(s===n.OP_PUSHDATA1){if(t+2>e.length)return null;r=e.readUInt8(t+1),i=2}else if(s===n.OP_PUSHDATA2){if(t+3>e.length)return null;r=e.readUInt16LE(t+1),i=3}else{if(t+5>e.length)return null;if(s!==n.OP_PUSHDATA4)throw new Error("Unexpected opcode");r=e.readUInt32LE(t+1),i=5}return{opcode:s,number:r,size:i}}}},77885:function(e,t,r){"use strict";e.exports=r(15238)(r(4818))},96230:function(e,t,r){"use strict";var n=r(46785).Buffer,i=Object.prototype.toString;t.isArray=function(e,t){if(!Array.isArray(e))throw TypeError(t)},t.isBoolean=function(e,t){if("[object Boolean]"!==i.call(e))throw TypeError(t)},t.isBuffer=function(e,t){if(!n.isBuffer(e))throw TypeError(t)},t.isFunction=function(e,t){if("[object Function]"!==i.call(e))throw TypeError(t)},t.isNumber=function(e,t){if("[object Number]"!==i.call(e))throw TypeError(t)},t.isObject=function(e,t){if("[object Object]"!==i.call(e))throw TypeError(t)},t.isBufferLength=function(e,t,r){if(e.length!==t)throw RangeError(r)},t.isBufferLength2=function(e,t,r,n){if(e.length!==t&&e.length!==r)throw RangeError(n)},t.isLengthGTZero=function(e,t){if(0===e.length)throw RangeError(t)},t.isNumberInInterval=function(e,t,r,n){if(e<=t||e>=r)throw RangeError(n)}},20528:function(e,t,r){"use strict";var n=r(52761).Buffer,i=r(19443),s=n.from([48,129,211,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,133,48,129,130,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,33,2,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,36,3,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),o=n.from([48,130,1,19,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,165,48,129,162,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,65,4,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,72,58,218,119,38,163,196,101,93,164,251,252,14,17,8,168,253,23,180,72,166,133,84,25,156,71,208,143,251,16,212,184,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,68,3,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);t.privateKeyExport=function(e,t,r){var i=n.from(r?s:o);return e.copy(i,r?8:9),t.copy(i,r?181:214),i},t.privateKeyImport=function(e){var t=e.length,r=0;if(!(t<r+1||48!==e[r])&&!(t<(r+=1)+1)&&128&e[r]){var n=127&e[r];if(r+=1,!(n<1||n>2)&&!(t<r+n)){var i=e[r+n-1]|(n>1?e[r+n-2]<<8:0);if(!(t<(r+=n)+i)&&!(t<r+3||2!==e[r]||1!==e[r+1]||1!==e[r+2])&&!(t<(r+=3)+2||4!==e[r]||e[r+1]>32||t<r+2+e[r+1]))return e.slice(r+2,r+2+e[r+1])}}},t.signatureExport=function(e){for(var t=n.concat([n.from([0]),e.r]),r=33,s=0;r>1&&0===t[s]&&!(128&t[s+1]);--r,++s);for(var o=n.concat([n.from([0]),e.s]),u=33,a=0;u>1&&0===o[a]&&!(128&o[a+1]);--u,++a);return i.encode(t.slice(s),o.slice(a))},t.signatureImport=function(e){var t=n.alloc(32,0),r=n.alloc(32,0);try{var s=i.decode(e);if(33===s.r.length&&0===s.r[0]&&(s.r=s.r.slice(1)),s.r.length>32)throw new Error("R length is too long");if(33===s.s.length&&0===s.s[0]&&(s.s=s.s.slice(1)),s.s.length>32)throw new Error("S length is too long")}catch(o){return}return s.r.copy(t,32-s.r.length),s.s.copy(r,32-s.s.length),{r:t,s:r}},t.signatureImportLax=function(e){var t=n.alloc(32,0),r=n.alloc(32,0),i=e.length,s=0;if(48===e[s++]){var o=e[s++];if(!(128&o&&(s+=o-128)>i)&&2===e[s++]){var u=e[s++];if(128&u){if(s+(o=u-128)>i)return;for(;o>0&&0===e[s];s+=1,o-=1);for(u=0;o>0;s+=1,o-=1)u=(u<<8)+e[s]}if(!(u>i-s)){var a=s;if(s+=u,2===e[s++]){var c=e[s++];if(128&c){if(s+(o=c-128)>i)return;for(;o>0&&0===e[s];s+=1,o-=1);for(c=0;o>0;s+=1,o-=1)c=(c<<8)+e[s]}if(!(c>i-s)){var p=s;for(s+=c;u>0&&0===e[a];u-=1,a+=1);if(!(u>32)){var f=e.slice(a,a+u);for(f.copy(t,32-f.length);c>0&&0===e[p];c-=1,p+=1);if(!(c>32)){var h=e.slice(p,p+c);return h.copy(r,32-h.length),{r:t,s:r}}}}}}}}}},4818:function(e,t,r){"use strict";var n=r(52761).Buffer,i=r(2757),s=r(89309),o=r(12166).ec,u=r(69610),a=new o("secp256k1"),c=a.curve;function p(e){var t=e[0];switch(t){case 2:case 3:return 33!==e.length?null:function(e,t){var r=new s(t);if(r.cmp(c.p)>=0)return null;var n=(r=r.toRed(c.red)).redSqr().redIMul(r).redIAdd(c.b).redSqrt();return 3===e!==n.isOdd()&&(n=n.redNeg()),a.keyPair({pub:{x:r,y:n}})}(t,e.slice(1,33));case 4:case 6:case 7:return 65!==e.length?null:function(e,t,r){var n=new s(t),i=new s(r);if(n.cmp(c.p)>=0||i.cmp(c.p)>=0)return null;if(n=n.toRed(c.red),i=i.toRed(c.red),(6===e||7===e)&&i.isOdd()!==(7===e))return null;var o=n.redSqr().redIMul(n);return i.redSqr().redISub(o.redIAdd(c.b)).isZero()?a.keyPair({pub:{x:n,y:i}}):null}(t,e.slice(1,33),e.slice(33,65));default:return null}}t.privateKeyVerify=function(e){var t=new s(e);return t.cmp(c.n)<0&&!t.isZero()},t.privateKeyExport=function(e,t){var r=new s(e);if(r.cmp(c.n)>=0||r.isZero())throw new Error(u.EC_PRIVATE_KEY_EXPORT_DER_FAIL);return n.from(a.keyFromPrivate(e).getPublic(t,!0))},t.privateKeyNegate=function(e){var t=new s(e);return t.isZero()?n.alloc(32):c.n.sub(t).umod(c.n).toArrayLike(n,"be",32)},t.privateKeyModInverse=function(e){var t=new s(e);if(t.cmp(c.n)>=0||t.isZero())throw new Error(u.EC_PRIVATE_KEY_RANGE_INVALID);return t.invm(c.n).toArrayLike(n,"be",32)},t.privateKeyTweakAdd=function(e,t){var r=new s(t);if(r.cmp(c.n)>=0)throw new Error(u.EC_PRIVATE_KEY_TWEAK_ADD_FAIL);if(r.iadd(new s(e)),r.cmp(c.n)>=0&&r.isub(c.n),r.isZero())throw new Error(u.EC_PRIVATE_KEY_TWEAK_ADD_FAIL);return r.toArrayLike(n,"be",32)},t.privateKeyTweakMul=function(e,t){var r=new s(t);if(r.cmp(c.n)>=0||r.isZero())throw new Error(u.EC_PRIVATE_KEY_TWEAK_MUL_FAIL);return r.imul(new s(e)),r.cmp(c.n)&&(r=r.umod(c.n)),r.toArrayLike(n,"be",32)},t.publicKeyCreate=function(e,t){var r=new s(e);if(r.cmp(c.n)>=0||r.isZero())throw new Error(u.EC_PUBLIC_KEY_CREATE_FAIL);return n.from(a.keyFromPrivate(e).getPublic(t,!0))},t.publicKeyConvert=function(e,t){var r=p(e);if(null===r)throw new Error(u.EC_PUBLIC_KEY_PARSE_FAIL);return n.from(r.getPublic(t,!0))},t.publicKeyVerify=function(e){return null!==p(e)},t.publicKeyTweakAdd=function(e,t,r){var i=p(e);if(null===i)throw new Error(u.EC_PUBLIC_KEY_PARSE_FAIL);if((t=new s(t)).cmp(c.n)>=0)throw new Error(u.EC_PUBLIC_KEY_TWEAK_ADD_FAIL);var o=c.g.mul(t).add(i.pub);if(o.isInfinity())throw new Error(u.EC_PUBLIC_KEY_TWEAK_ADD_FAIL);return n.from(o.encode(!0,r))},t.publicKeyTweakMul=function(e,t,r){var i=p(e);if(null===i)throw new Error(u.EC_PUBLIC_KEY_PARSE_FAIL);if((t=new s(t)).cmp(c.n)>=0||t.isZero())throw new Error(u.EC_PUBLIC_KEY_TWEAK_MUL_FAIL);return n.from(i.pub.mul(t).encode(!0,r))},t.publicKeyCombine=function(e,t){for(var r=new Array(e.length),i=0;i<e.length;++i)if(r[i]=p(e[i]),null===r[i])throw new Error(u.EC_PUBLIC_KEY_PARSE_FAIL);for(var s=r[0].pub,o=1;o<r.length;++o)s=s.add(r[o].pub);if(s.isInfinity())throw new Error(u.EC_PUBLIC_KEY_COMBINE_FAIL);return n.from(s.encode(!0,t))},t.signatureNormalize=function(e){var t=new s(e.slice(0,32)),r=new s(e.slice(32,64));if(t.cmp(c.n)>=0||r.cmp(c.n)>=0)throw new Error(u.ECDSA_SIGNATURE_PARSE_FAIL);var i=n.from(e);return 1===r.cmp(a.nh)&&c.n.sub(r).toArrayLike(n,"be",32).copy(i,32),i},t.signatureExport=function(e){var t=e.slice(0,32),r=e.slice(32,64);if(new s(t).cmp(c.n)>=0||new s(r).cmp(c.n)>=0)throw new Error(u.ECDSA_SIGNATURE_PARSE_FAIL);return{r:t,s:r}},t.signatureImport=function(e){var t=new s(e.r);t.cmp(c.n)>=0&&(t=new s(0));var r=new s(e.s);return r.cmp(c.n)>=0&&(r=new s(0)),n.concat([t.toArrayLike(n,"be",32),r.toArrayLike(n,"be",32)])},t.sign=function(e,t,r,i){if("function"===typeof r){var o=r;r=function(r){var a=o(e,t,null,i,r);if(!n.isBuffer(a)||32!==a.length)throw new Error(u.ECDSA_SIGN_FAIL);return new s(a)}}var p=new s(t);if(p.cmp(c.n)>=0||p.isZero())throw new Error(u.ECDSA_SIGN_FAIL);var f=a.sign(e,t,{canonical:!0,k:r,pers:i});return{signature:n.concat([f.r.toArrayLike(n,"be",32),f.s.toArrayLike(n,"be",32)]),recovery:f.recoveryParam}},t.verify=function(e,t,r){var n={r:t.slice(0,32),s:t.slice(32,64)},i=new s(n.r),o=new s(n.s);if(i.cmp(c.n)>=0||o.cmp(c.n)>=0)throw new Error(u.ECDSA_SIGNATURE_PARSE_FAIL);if(1===o.cmp(a.nh)||i.isZero()||o.isZero())return!1;var f=p(r);if(null===f)throw new Error(u.EC_PUBLIC_KEY_PARSE_FAIL);return a.verify(e,n,{x:f.pub.x,y:f.pub.y})},t.recover=function(e,t,r,i){var o={r:t.slice(0,32),s:t.slice(32,64)},p=new s(o.r),f=new s(o.s);if(p.cmp(c.n)>=0||f.cmp(c.n)>=0)throw new Error(u.ECDSA_SIGNATURE_PARSE_FAIL);try{if(p.isZero()||f.isZero())throw new Error;var h=a.recoverPubKey(e,o,r);return n.from(h.encode(!0,i))}catch(l){throw new Error(u.ECDSA_RECOVER_FAIL)}},t.ecdh=function(e,r){var n=t.ecdhUnsafe(e,r,!0);return i("sha256").update(n).digest()},t.ecdhUnsafe=function(e,t,r){var i=p(e);if(null===i)throw new Error(u.EC_PUBLIC_KEY_PARSE_FAIL);var o=new s(t);if(o.cmp(c.n)>=0||o.isZero())throw new Error(u.ECDH_FAIL);return n.from(i.pub.mul(o).encode(!0,r))}},15238:function(e,t,r){"use strict";var n=r(96230),i=r(20528),s=r(69610);function o(e,t){return void 0===e?t:(n.isBoolean(e,s.COMPRESSED_TYPE_INVALID),e)}e.exports=function(e){return{privateKeyVerify:function(t){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),32===t.length&&e.privateKeyVerify(t)},privateKeyExport:function(t,r){n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),r=o(r,!0);var u=e.privateKeyExport(t,r);return i.privateKeyExport(t,u,r)},privateKeyImport:function(t){if(n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),(t=i.privateKeyImport(t))&&32===t.length&&e.privateKeyVerify(t))return t;throw new Error(s.EC_PRIVATE_KEY_IMPORT_DER_FAIL)},privateKeyNegate:function(t){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),e.privateKeyNegate(t)},privateKeyModInverse:function(t){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),e.privateKeyModInverse(t)},privateKeyTweakAdd:function(t,r){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),n.isBuffer(r,s.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,s.TWEAK_LENGTH_INVALID),e.privateKeyTweakAdd(t,r)},privateKeyTweakMul:function(t,r){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),n.isBuffer(r,s.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,s.TWEAK_LENGTH_INVALID),e.privateKeyTweakMul(t,r)},publicKeyCreate:function(t,r){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),r=o(r,!0),e.publicKeyCreate(t,r)},publicKeyConvert:function(t,r){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),r=o(r,!0),e.publicKeyConvert(t,r)},publicKeyVerify:function(t){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),e.publicKeyVerify(t)},publicKeyTweakAdd:function(t,r,i){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,s.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,s.TWEAK_LENGTH_INVALID),i=o(i,!0),e.publicKeyTweakAdd(t,r,i)},publicKeyTweakMul:function(t,r,i){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,s.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,s.TWEAK_LENGTH_INVALID),i=o(i,!0),e.publicKeyTweakMul(t,r,i)},publicKeyCombine:function(t,r){n.isArray(t,s.EC_PUBLIC_KEYS_TYPE_INVALID),n.isLengthGTZero(t,s.EC_PUBLIC_KEYS_LENGTH_INVALID);for(var i=0;i<t.length;++i)n.isBuffer(t[i],s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t[i],33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID);return r=o(r,!0),e.publicKeyCombine(t,r)},signatureNormalize:function(t){return n.isBuffer(t,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(t,64,s.ECDSA_SIGNATURE_LENGTH_INVALID),e.signatureNormalize(t)},signatureExport:function(t){n.isBuffer(t,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(t,64,s.ECDSA_SIGNATURE_LENGTH_INVALID);var r=e.signatureExport(t);return i.signatureExport(r)},signatureImport:function(t){n.isBuffer(t,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isLengthGTZero(t,s.ECDSA_SIGNATURE_LENGTH_INVALID);var r=i.signatureImport(t);if(r)return e.signatureImport(r);throw new Error(s.ECDSA_SIGNATURE_PARSE_DER_FAIL)},signatureImportLax:function(t){n.isBuffer(t,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isLengthGTZero(t,s.ECDSA_SIGNATURE_LENGTH_INVALID);var r=i.signatureImportLax(t);if(r)return e.signatureImport(r);throw new Error(s.ECDSA_SIGNATURE_PARSE_DER_FAIL)},sign:function(t,r,i){n.isBuffer(t,s.MSG32_TYPE_INVALID),n.isBufferLength(t,32,s.MSG32_LENGTH_INVALID),n.isBuffer(r,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(r,32,s.EC_PRIVATE_KEY_LENGTH_INVALID);var o=null,u=null;return void 0!==i&&(n.isObject(i,s.OPTIONS_TYPE_INVALID),void 0!==i.data&&(n.isBuffer(i.data,s.OPTIONS_DATA_TYPE_INVALID),n.isBufferLength(i.data,32,s.OPTIONS_DATA_LENGTH_INVALID),o=i.data),void 0!==i.noncefn&&(n.isFunction(i.noncefn,s.OPTIONS_NONCEFN_TYPE_INVALID),u=i.noncefn)),e.sign(t,r,u,o)},verify:function(t,r,i){return n.isBuffer(t,s.MSG32_TYPE_INVALID),n.isBufferLength(t,32,s.MSG32_LENGTH_INVALID),n.isBuffer(r,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(r,64,s.ECDSA_SIGNATURE_LENGTH_INVALID),n.isBuffer(i,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(i,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),e.verify(t,r,i)},recover:function(t,r,i,u){return n.isBuffer(t,s.MSG32_TYPE_INVALID),n.isBufferLength(t,32,s.MSG32_LENGTH_INVALID),n.isBuffer(r,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(r,64,s.ECDSA_SIGNATURE_LENGTH_INVALID),n.isNumber(i,s.RECOVERY_ID_TYPE_INVALID),n.isNumberInInterval(i,-1,4,s.RECOVERY_ID_VALUE_INVALID),u=o(u,!0),e.recover(t,r,i,u)},ecdh:function(t,r){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(r,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),e.ecdh(t,r)},ecdhUnsafe:function(t,r,i){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(r,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),i=o(i,!0),e.ecdhUnsafe(t,r,i)}}}},52941:function(e,t,r){"use strict";var n=r(52761).Buffer;function i(e){if(e<0||e>9007199254740991||e%1!==0)throw new RangeError("value out of range")}function s(e){return i(e),e<253?1:e<=65535?3:e<=4294967295?5:9}e.exports={encode:function e(t,r,o){if(i(t),r||(r=n.allocUnsafe(s(t))),!n.isBuffer(r))throw new TypeError("buffer must be a Buffer instance");return o||(o=0),t<253?(r.writeUInt8(t,o),e.bytes=1):t<=65535?(r.writeUInt8(253,o),r.writeUInt16LE(t,o+1),e.bytes=3):t<=4294967295?(r.writeUInt8(254,o),r.writeUInt32LE(t,o+1),e.bytes=5):(r.writeUInt8(255,o),r.writeUInt32LE(t>>>0,o+1),r.writeUInt32LE(t/4294967296|0,o+5),e.bytes=9),r},decode:function e(t,r){if(!n.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");r||(r=0);var s=t.readUInt8(r);if(s<253)return e.bytes=1,s;if(253===s)return e.bytes=3,t.readUInt16LE(r+1);if(254===s)return e.bytes=5,t.readUInt32LE(r+1);e.bytes=9;var o=t.readUInt32LE(r+1),u=4294967296*t.readUInt32LE(r+5)+o;return i(u),u},encodingLength:s}},78430:function(e,t,r){"use strict";function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}r.d(t,{Z:function(){return n}})},83819:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(5937);function i(e,t,r){return i="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=(0,n.Z)(e)););return e}(e,t);if(i){var s=Object.getOwnPropertyDescriptor(i,t);return s.get?s.get.call(r):s.value}},i(e,t,r||e)}},5937:function(e,t,r){"use strict";function n(e){return n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(e)}r.d(t,{Z:function(){return n}})},95493:function(e,t,r){"use strict";function n(e,t){return n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(e,t)}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}r.d(t,{Z:function(){return i}})},83251:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(267),i=r(78430);function s(e,t){if(t&&("object"===n(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return(0,i.Z)(e)}},39991:function(e){"use strict";e.exports=JSON.parse('{"OP_FALSE":0,"OP_0":0,"OP_PUSHDATA1":76,"OP_PUSHDATA2":77,"OP_PUSHDATA4":78,"OP_1NEGATE":79,"OP_RESERVED":80,"OP_TRUE":81,"OP_1":81,"OP_2":82,"OP_3":83,"OP_4":84,"OP_5":85,"OP_6":86,"OP_7":87,"OP_8":88,"OP_9":89,"OP_10":90,"OP_11":91,"OP_12":92,"OP_13":93,"OP_14":94,"OP_15":95,"OP_16":96,"OP_NOP":97,"OP_VER":98,"OP_IF":99,"OP_NOTIF":100,"OP_VERIF":101,"OP_VERNOTIF":102,"OP_ELSE":103,"OP_ENDIF":104,"OP_VERIFY":105,"OP_RETURN":106,"OP_TOALTSTACK":107,"OP_FROMALTSTACK":108,"OP_2DROP":109,"OP_2DUP":110,"OP_3DUP":111,"OP_2OVER":112,"OP_2ROT":113,"OP_2SWAP":114,"OP_IFDUP":115,"OP_DEPTH":116,"OP_DROP":117,"OP_DUP":118,"OP_NIP":119,"OP_OVER":120,"OP_PICK":121,"OP_ROLL":122,"OP_ROT":123,"OP_SWAP":124,"OP_TUCK":125,"OP_CAT":126,"OP_SUBSTR":127,"OP_LEFT":128,"OP_RIGHT":129,"OP_SIZE":130,"OP_INVERT":131,"OP_AND":132,"OP_OR":133,"OP_XOR":134,"OP_EQUAL":135,"OP_EQUALVERIFY":136,"OP_RESERVED1":137,"OP_RESERVED2":138,"OP_1ADD":139,"OP_1SUB":140,"OP_2MUL":141,"OP_2DIV":142,"OP_NEGATE":143,"OP_ABS":144,"OP_NOT":145,"OP_0NOTEQUAL":146,"OP_ADD":147,"OP_SUB":148,"OP_MUL":149,"OP_DIV":150,"OP_MOD":151,"OP_LSHIFT":152,"OP_RSHIFT":153,"OP_BOOLAND":154,"OP_BOOLOR":155,"OP_NUMEQUAL":156,"OP_NUMEQUALVERIFY":157,"OP_NUMNOTEQUAL":158,"OP_LESSTHAN":159,"OP_GREATERTHAN":160,"OP_LESSTHANOREQUAL":161,"OP_GREATERTHANOREQUAL":162,"OP_MIN":163,"OP_MAX":164,"OP_WITHIN":165,"OP_RIPEMD160":166,"OP_SHA1":167,"OP_SHA256":168,"OP_HASH160":169,"OP_HASH256":170,"OP_CODESEPARATOR":171,"OP_CHECKSIG":172,"OP_CHECKSIGVERIFY":173,"OP_CHECKMULTISIG":174,"OP_CHECKMULTISIGVERIFY":175,"OP_NOP1":176,"OP_NOP2":177,"OP_CHECKLOCKTIMEVERIFY":177,"OP_NOP3":178,"OP_CHECKSEQUENCEVERIFY":178,"OP_NOP4":179,"OP_NOP5":180,"OP_NOP6":181,"OP_NOP7":182,"OP_NOP8":183,"OP_NOP9":184,"OP_NOP10":185,"OP_PUBKEYHASH":253,"OP_PUBKEY":254,"OP_INVALIDOPCODE":255}')},69610:function(e){"use strict";e.exports=JSON.parse('{"COMPRESSED_TYPE_INVALID":"compressed should be a boolean","EC_PRIVATE_KEY_TYPE_INVALID":"private key should be a Buffer","EC_PRIVATE_KEY_LENGTH_INVALID":"private key length is invalid","EC_PRIVATE_KEY_RANGE_INVALID":"private key range is invalid","EC_PRIVATE_KEY_TWEAK_ADD_FAIL":"tweak out of range or resulting private key is invalid","EC_PRIVATE_KEY_TWEAK_MUL_FAIL":"tweak out of range","EC_PRIVATE_KEY_EXPORT_DER_FAIL":"couldn\'t export to DER format","EC_PRIVATE_KEY_IMPORT_DER_FAIL":"couldn\'t import from DER format","EC_PUBLIC_KEYS_TYPE_INVALID":"public keys should be an Array","EC_PUBLIC_KEYS_LENGTH_INVALID":"public keys Array should have at least 1 element","EC_PUBLIC_KEY_TYPE_INVALID":"public key should be a Buffer","EC_PUBLIC_KEY_LENGTH_INVALID":"public key length is invalid","EC_PUBLIC_KEY_PARSE_FAIL":"the public key could not be parsed or is invalid","EC_PUBLIC_KEY_CREATE_FAIL":"private was invalid, try again","EC_PUBLIC_KEY_TWEAK_ADD_FAIL":"tweak out of range or resulting public key is invalid","EC_PUBLIC_KEY_TWEAK_MUL_FAIL":"tweak out of range","EC_PUBLIC_KEY_COMBINE_FAIL":"the sum of the public keys is not valid","ECDH_FAIL":"scalar was invalid (zero or overflow)","ECDSA_SIGNATURE_TYPE_INVALID":"signature should be a Buffer","ECDSA_SIGNATURE_LENGTH_INVALID":"signature length is invalid","ECDSA_SIGNATURE_PARSE_FAIL":"couldn\'t parse signature","ECDSA_SIGNATURE_PARSE_DER_FAIL":"couldn\'t parse DER signature","ECDSA_SIGNATURE_SERIALIZE_DER_FAIL":"couldn\'t serialize signature to DER format","ECDSA_SIGN_FAIL":"nonce generation function failed or private key is invalid","ECDSA_RECOVER_FAIL":"couldn\'t recover public key from signature","MSG32_TYPE_INVALID":"message should be a Buffer","MSG32_LENGTH_INVALID":"message length is invalid","OPTIONS_TYPE_INVALID":"options should be an Object","OPTIONS_DATA_TYPE_INVALID":"options.data should be a Buffer","OPTIONS_DATA_LENGTH_INVALID":"options.data length is invalid","OPTIONS_NONCEFN_TYPE_INVALID":"options.noncefn should be a Function","RECOVERY_ID_TYPE_INVALID":"recovery should be a Number","RECOVERY_ID_VALUE_INVALID":"recovery should have value between -1 and 4","TWEAK_TYPE_INVALID":"tweak should be a Buffer","TWEAK_LENGTH_INVALID":"tweak length is invalid"}')}}]);